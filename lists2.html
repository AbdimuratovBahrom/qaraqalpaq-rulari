

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qaraqalpaq tuwrlar - Spisok</title>
    <style>
        :root {
            --primary-bg: #0f1419;
            --secondary-bg: #1a1f2e;
            --accent-red: #e74c3c;
            --accent-orange: #e67e22;
            --accent-yellow: #f1c40f;
            --gold: #f1c40f;
            --accent-green: #2ecc71;
            --accent-blue: #3498db;
            --accent-purple: #9b59b6;
            --accent-cyan: #1abc9c;
            --text-primary: #ecf0f1;
            --text-secondary: #bdc3c7;
            --border-color: #34495e;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0f1419 0%, #1a1f2e 100%);
            min-height: 100vh;
            color: var(--text-primary);
            overflow-x: hidden;
            padding-top: 80px;
        }

        header {
            position: fixed;
            top: 0; left: 0; right: 0;
            background: rgba(10,12,16,0.95);
            border-bottom: 2px solid var(--gold);
            padding: 1rem 2rem;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(10px);
            height: 70px;
        }

        .logo { 
            display: flex; 
            align-items: center; 
            gap: 10px;
        }
        
        .logo a { 
            font-family: 'Cormorant Garamond', serif; 
            color: var(--gold); 
            font-size: 1.8rem; 
            margin: 0;
            text-decoration: none;
        }
        
        .burger-menu {
            display: none;
            flex-direction: column;
            justify-content: space-around;
            width: 30px;
            height: 25px;
            background: transparent;
            border: none;
            cursor: pointer;
            padding: 0;
            z-index: 1001;
        }
        
        .burger-bar {
            width: 100%;
            height: 3px;
            background: var(--gold);
            border-radius: 2px;
            transition: all 0.3s ease;
        }
        
        .burger-menu.active .burger-bar:nth-child(1) {
            transform: rotate(45deg) translate(6px, 6px);
        }
        
        .burger-menu.active .burger-bar:nth-child(2) {
            opacity: 0;
        }
        
        .burger-menu.active .burger-bar:nth-child(3) {
            transform: rotate(-45deg) translate(6px, -6px);
        }
        
        .view-switch {
            display: flex;
            gap: 0.5rem;
            background: rgba(255,255,255,0.1);
            padding: 0.25rem;
            border-radius: 20px;
        }
        
        @media (max-width: 768px) {
            .burger-menu { display: flex; }
            .view-switch {
                position: fixed;
                top: 70px;
                left: 0;
                right: 0;
                background: rgba(10,12,16,0.98);
                flex-direction: column;
                padding: 1rem;
                border-bottom: 2px solid var(--gold);
                border-radius: 0;
                transform: translateY(-100%);
                opacity: 0;
                visibility: hidden;
                transition: all 0.3s ease;
            }
            .view-switch.active {
                transform: translateY(0);
                opacity: 1;
                visibility: visible;
            }
            .view-btn { width: 100%; text-align: center; padding: 1rem; }
        }
        
        .view-btn {
            padding: 0.5rem 1.5rem;
            border-radius: 16px;
            border: none;
            background: transparent;
            color: #8892b0;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            font-size: 0.9rem;
        }
        
        .view-btn:hover {
            color: var(--text-primary);
            background: rgba(255,255,255,0.1);
        }
        
        .view-btn.active {
            background: var(--gold);
            color: #000;
            font-weight: 600;
        }

        .container { 
            display: flex; 
            height: calc(100vh - 80px);
            overflow: hidden; 
            position: relative;
        }
        
        .list-panel { 
            flex: 1; 
            overflow-y: auto; 
            padding: 20px; 
            background: rgba(15, 20, 25, 0.98);
        }
        
        .info-panel {
            width: 450px; 
            background: var(--secondary-bg); 
            border-left: 3px solid var(--accent-orange);
            padding: 20px; 
            overflow-y: auto; 
            box-shadow: -5px 0 25px rgba(0,0,0,0.4);
            transition: all 0.3s ease;
            transform: translateX(0);
        }
        
        .info-panel.collapsed {
            transform: translateX(100%);
            width: 0;
            padding: 0;
            overflow: hidden;
            border-left: none;
        }
        
        .close-panel-btn {
            position: sticky;
            top: 10px;
            left: 400px;
            background: var(--accent-red);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }
        
        .close-panel-btn:hover {
            background: #c0392b;
            transform: scale(1.1);
        }
        
        .open-panel-btn {
            position: fixed;
            right: 20px;
            bottom: 100px;
            background: var(--gold);
            color: #000;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5em;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 999;
            box-shadow: 0 4px 15px rgba(241, 196, 15, 0.4);
        }
        
        .open-panel-btn.visible { display: flex; }
        
        h1 { text-align: center; color: var(--accent-yellow); margin-bottom: 5px; font-size: 1.8em; }
        .subtitle { text-align: center; color: var(--text-secondary); margin-bottom: 20px; font-size: 0.9em; }

        .accordion { max-width: 800px; margin: 0 auto; }
        
        .accordion-item {
            margin-bottom: 10px;
            border-radius: 8px;
            overflow: hidden;
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
        }
        
        .accordion-header {
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .accordion-header:hover { background: rgba(255,255,255,0.05); }
        
        .accordion-icon {
            transition: transform 0.3s;
            font-size: 1.2em;
            color: var(--gold);
        }
        
        .accordion-item.active .accordion-icon { transform: rotate(180deg); }
        
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
            background: rgba(0,0,0,0.2);
        }
        
        .accordion-item.active .accordion-content { max-height: 3000px; }
        
        .accordion-inner { padding: 15px 20px; }

        /* –£—Ä–æ–≤–Ω–∏ —Ü–≤–µ—Ç–æ–≤ */
        .level-0 { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .level-1 { background: linear-gradient(135deg, #e67e22, #d35400); color: white; }
        .level-2 { background: linear-gradient(135deg, #f1c40f, #f39c12); color: #2c3e50; }
        .level-3 { background: linear-gradient(135deg, #2ecc71, #27ae60); color: white; }
        .level-4 { background: linear-gradient(135deg, #3498db, #2980b9); color: white; }
        .level-5 { background: linear-gradient(135deg, #9b59b6, #8e44ad); color: white; }
        .level-6 { background: linear-gradient(135deg, #1abc9c, #16a085); color: white; }

        .sub-item {
            padding: 10px 15px;
            margin: 5px 0;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid transparent;
        }
        
        .sub-item:hover {
            background: rgba(255,255,255,0.1);
            border-left-color: var(--gold);
            transform: translateX(5px);
        }
        
        .sub-item .name { font-weight: 500; }
        .sub-item .type { font-size: 0.8em; opacity: 0.8; font-style: italic; }
        
        .badge {
            background: rgba(255,255,255,0.2);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75em;
            margin-left: 10px;
        }

        .info-header { border-bottom: 2px solid var(--accent-orange); padding-bottom: 10px; margin-bottom: 12px; }
        .info-title { font-size: 1.4em; color: var(--accent-yellow); margin-bottom: 5px; }
        .info-type { color: var(--accent-orange); font-size: 0.9em; text-transform: uppercase; letter-spacing: 1px; }
        .info-section { margin-bottom: 12px; background: rgba(255,255,255,0.03); padding: 12px; border-radius: 5px; border-left: 3px solid var(--accent-blue); }
        .info-section h3 { color: var(--accent-cyan); margin-bottom: 8px; font-size: 0.9em; display: flex; align-items: center; gap: 8px; }
        .info-section p { color: var(--text-secondary); line-height: 1.5; font-size: 0.9em; text-align: justify; }

        .tamga-box, .uran-box {
            background: rgba(231, 76, 60, 0.15);
            border: 2px solid var(--accent-red);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            margin: 12px 0;
        }
        .uran-box {
            background: rgba(46, 204, 113, 0.15);
            border-color: var(--accent-green);
        }
        .tamga-symbol { font-size: 2.5em; color: var(--accent-yellow); font-weight: bold; }
        .uran-text { font-size: 1.6em; color: var(--accent-green); font-weight: bold; font-style: italic; }

        .hierarchy-chain {
            background: linear-gradient(135deg, rgba(241, 196, 15, 0.1), rgba(230, 126, 34, 0.1));
            border: 2px solid var(--accent-yellow);
            border-radius: 8px;
            padding: 15px;
            margin: 12px 0;
        }
        .hierarchy-item {
            display: flex;
            align-items: center;
            padding: 6px 0;
            border-bottom: 1px dashed rgba(241, 196, 15, 0.3);
        }
        .hierarchy-item:last-child { border-bottom: none; font-weight: bold; color: var(--accent-yellow); }
        .hierarchy-arrow { margin: 0 10px; color: var(--accent-orange); }
        .hierarchy-level {
            background: var(--accent-yellow);
            color: #000;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75em;
            margin-right: 10px;
            min-width: 70px;
            text-align: center;
        }

        .search-box {
            position: fixed;
            top: 90px;
            left: 20px;
            z-index: 100;
        }
        .search-box input {
            padding: 8px 12px;
            border-radius: 20px;
            border: 1px solid var(--accent-blue);
            background: rgba(0,0,0,0.85);
            color: white;
            width: 220px;
            font-size: 0.9em;
        }

        .highlight {
            animation: pulse 1.5s infinite;
            border: 2px solid var(--accent-yellow) !important;
            background: rgba(241, 196, 15, 0.15) !important;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(241, 196, 15, 0.7); }
            70% { box-shadow: 0 0 0 12px rgba(241, 196, 15, 0); }
            100% { box-shadow: 0 0 0 0 rgba(241, 196, 15, 0); }
        }

        @media (max-width: 1024px) {
            .search-box { top: 85px; left: 15px; }
            .search-box input { width: 200px; }
        }

        @media (max-width: 968px) {
            .info-panel {
                width: 100%;
                position: fixed;
                bottom: 0;
                left: 0;
                height: 65vh;
                transform: translateY(100%);
                transition: transform 0.4s ease;
                z-index: 1000;
                border-left: none;
                border-top: 3px solid var(--accent-orange);
            }
            .info-panel.active { transform: translateY(0); }
            .info-panel.collapsed { transform: translateY(100%); }
            .close-panel-btn { left: auto; right: 20px; }
        }

        @media (max-width: 600px) {
            .search-box input { width: 180px; }
            header { padding: 0.8rem 1.2rem; }
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">
            <span style="font-size: 2rem;">üìã</span>
            <a href="./images/uru.jpg" target="_blank">QARAQALPAQ URIW</a>
        </div>
        
        <button class="burger-menu" id="burgerMenu" aria-label="–ú”ô–∑—ñ—Ä">
            <span class="burger-bar"></span>
            <span class="burger-bar"></span>
            <span class="burger-bar"></span>
        </button>
        
        <div class="view-switch" id="viewSwitch">
            <a href="index.html" class="view-btn">üè† –ì–ª–∞–≤–Ω–æ–µ</a>
            <a href="lists.html" class="view-btn active">üìã –°–ø–∏—Å–∫–∏</a>
            <a href="scheme.html" class="view-btn">üå≥ –°—Ö–µ–º–∞</a>
            <a href="exogamy.html" class="view-btn">üíë –≠–∫–∑–æ–≥–∞–º–∏—è</a>
        </div>
    </header>

    <div class="search-box">
        <input type="text" id="searchInput" placeholder="–ò–∑–ª–µ—û... (–ü–æ–∏—Å–∫)" onkeyup="searchAccordion()">
    </div>
    
    <div class="container">
        <div class="list-panel" id="listPanel">
            <h1 style="margin-top: 20px;">QARAQALPAQ URUWLARI</h1>
            <div class="subtitle">–¢—É—û–ª–∞—Ä –¥–∏–∑–∏–º–∏ / –°–ø–∏—Å–æ–∫ —Ä–æ–¥–æ–≤</div>
            <div class="accordion" id="accordion"></div>
        </div>

        <div class="info-panel collapsed" id="infoPanel">
            <button class="close-panel-btn" id="closePanelBtn" title="–ñ–∞–±—ã—û / –ó–∞–∫—Ä—ã—Ç—å">√ó</button>
            <div id="infoContent">
                <div class="info-header">
                    <div class="info-title">–≠–ª–µ–º–µ–Ω—Ç—Ç–∏ —Ç–∞“£–ª–∞“£</div>
                    <div class="info-type">–ú–∞“ì–ª—ã—û–º–∞—Ç –∞–ª—ã—û —É—à—ã–Ω —Ç—É—û–¥—ã –±–∞—Å—ã“£</div>
                </div>
            </div>
        </div>
    </div>
    
    <button class="open-panel-btn visible" id="openPanelBtn" title="–ú–∞“ì–ª—ã—û–º–∞—Ç –ø–∞–Ω–µ–ª–∏–Ω –∞—à—ã—û">‚ÑπÔ∏è</button>

    <script>
        const levelsMap = [
            '–•–∞–ª—ã“õ / Xalƒ±q',
            '–ê—Ä—ã—Å',
            '–ë”©–ª—ñ–º / B√∂l√≠m',
            '“Æ–ª–∫–µ–Ω —É—Ä—É—û / Ulken uruw',
            '–†—É / Uruw',
            '–¢–∏–π—Ä–µ',
            '–ö”©—à–µ'
        ];

        let isPanelOpen = false;
        let currentSelectedNode = null;

        // –ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –∏ –¥–æ–ø–æ–ª–Ω–µ–Ω–Ω–∞—è)
        const treeData = {
            id: "root",
            name: "QARAQALPAQLAR",
            level: 0,
            type: "Xalƒ±q",
            info: {
                history: "“ö–∞—Ä–∞“õ–∞–ª–ø–∞“õ–ª–∞—Ä ‚Äî –û—Ä—Ç–∞ –ê–∑–∏—è–¥–∞“ì—ã —Ç“Ø—Ä–∫—ñ —Ç—ñ–ª–¥–µ—Å —Ö–∞–ª—ã“õ. XVI‚ÄìXVIII “ì–∞—Å—ã—Ä–ª–∞—Ä–¥–∞ “õ–∞–ª—ã–ø—Ç–∞—Å“õ–∞–Ω. –ù–µ–≥—ñ–∑—ñ –ù–æ“ì–∞–π –æ—Ä–¥–∞—Å—ã, “ö—ã–ø—à–∞“õ, “ö–∞—Ä–ª“±“õ —Ç–∞–π–ø–∞–ª–∞—Ä—ã–Ω—ã“£ “õ–æ—Å—ã–Ω–¥—ã—Å—ã–Ω–∞–Ω “õ“±—Ä–∞–ª“ì–∞–Ω.",
                origin: "“∞–ª—ã –¥–∞–ª–∞ –∫”©—à–ø–µ–Ω–¥—ñ–ª–µ—Ä—ñ–Ω—ñ“£ “±—Ä–ø–∞“ì—ã.",
                legend: "–ê“£—ã–∑ –±–æ–π—ã–Ω—à–∞ –∞–ª“ì–∞—à“õ—ã–¥–∞ –ê–ª—Ç–∞–π ”©“£—ñ—Ä—ñ–Ω–¥–µ ”©–º—ñ—Ä —Å“Ø—Ä–≥–µ–Ω, –∫–µ–π—ñ–Ω –ê—Ä–∞–ª –º–∞“£—ã –º–µ–Ω –°—ã—Ä–¥–∞—Ä–∏—è –±–æ–π—ã–Ω–∞ –∫”©—à—ñ–ø –∫–µ–ª–≥–µ–Ω.",
                population: "“ö–∞–∑—ñ—Ä–≥—ñ —É–∞“õ—ã—Ç—Ç–∞ —à–∞–º–∞–º–µ–Ω 800‚Äì850 –º—ã“£ –∞–¥–∞–º.",
                region: "”®–∑–±–µ–∫—Å—Ç–∞–Ω –†–µ—Å–ø—É–±–ª–∏–∫–∞—Å—ã “ö–∞—Ä–∞“õ–∞–ª–ø–∞“õ—Å—Ç–∞–Ω –ê–†, “ö–∞–∑–∞“õ—Å—Ç–∞–Ω–Ω—ã“£ –æ“£—Ç“Ø—Å—Ç—ñ–∫-–±–∞—Ç—ã—Å –æ–±–ª—ã—Å—Ç–∞—Ä—ã."
            },
            children: [
                {
                    id: "conyrat",
                    name: "–ê–†–´–° “ö–û“¢–´–†–ê–¢",
                    level: 1,
                    type: "–ê—Ä—ã—Å",
                    tamga: "–ü (–±–æ—Å–∞“ì–∞)",
                    uran: "“ö–∞“õ–ø–∞!",
                    info: {
                        history: "“ö–æ“£—ã—Ä–∞—Ç ‚Äî “õ–∞—Ä–∞“õ–∞–ª–ø–∞“õ–ª–∞—Ä–¥—ã“£ –µ–∫—ñ –Ω–µ–≥—ñ–∑–≥—ñ –∞—Ä—ã—Å—ã–Ω—ã“£ –±—ñ—Ä—ñ. –ù–æ“ì–∞–π –æ—Ä–¥–∞—Å—ã “õ“±—Ä–∞–º—ã–Ω–¥–∞ “õ–∞–ª—ã–ø—Ç–∞—Å“õ–∞–Ω.",
                        population: "–®–∞–º–∞–º–µ–Ω 40% “õ–∞—Ä–∞“õ–∞–ª–ø–∞“õ–ª–∞—Ä–¥—ã“£ “õ“±—Ä–∞–º—ã–Ω–¥–∞",
                        structure: "–ï–∫—ñ –±”©–ª—ñ–º: –®—É–ª—ã“õ (8 —Ä—É) –∂”ô–Ω–µ –ñ–∞—É—ã–Ω–≥—ã—Ä (7 —Ä—É)"
                    },
                    children: [
                        // –®—É–ª—ã“õ –±”©–ª—ñ–º—ñ (–ø–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±—ã–ª–∞, –æ—Å—Ç–∞–≤–∏–ª –∫–∞–∫ –µ—Å—Ç—å, –Ω–æ –ø—Ä–æ–≤–µ—Ä–∏–ª —Å–∫–æ–±–∫–∏)
                        {
                            id: "shulyk",
                            name: "–®–£–õ–´“ö –ë”®–õ–Ü–ú–Ü",
                            level: 2,
                            type: "–ë”©–ª—ñ–º",
                            children: [
                                { id: "kyat", name: "“ö–´–Ø–¢", level: 3, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "|||", uran: "–ê–ª–∞—Ç–∞—É!" },
                                { id: "ashamayly", name: "–ê–®–ê–ú–ê–ô–õ–´", level: 3, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "–ê–®", uran: "–®—É–ª—ã“õ!" },
                                { id: "koldauli", name: "“ö–û–õ–î–ê–£–õ–´", level: 3, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "“ö–õ–î", uran: "“ö–æ–ª–¥–∞—É!" },
                                { id: "kostambali", name: "“ö–û–°–¢–ê“¢–ë–ê–õ–´", level: 3, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "II", uran: "“ö–æ—Å“õ–∞!" },
                                { id: "balgali", name: "–ë–ê–õ“í–ê–õ–´", level: 3, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "–ë", uran: "–ë–∞–ª“ì–∞!" },
                                { id: "kandekli", name: "–ö”®–ù–î–ï–ö–õ–Ü", level: 3, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "–ì", uran: "–ö”©–Ω–¥–µ–∫!" },
                                { id: "karamoiyn", name: "“ö–ê–†–ê–ú–û–ô–´–ù", level: 3, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "–¢–ú", uran: "–ú–æ–π—ã–Ω!" },
                                { id: "muyten", name: "–ú“Æ–ô–¢–ï–ù", level: 3, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "“Æ—à —à–∞–Ω—ã—à“õ—ã", uran: "–ê“õ—à–æ–ª–ø–∞–Ω!" }
                            ]
                        },
                        {
                            id: "jauyngyr",
                            name: "–ñ–ê–£–´–ù–ì–´–† –ë”®–õ–Ü–ú–Ü",
                            level: 2,
                            type: "–ë”©–ª—ñ–º",
                            children: [
                                { id: "teristambaly", name: "–¢–ï–†–Ü–°–¢–ê“¢–ë–ê–õ–´", level: 3, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "–¢–¢", uran: "–ñ–∞—É—ã–Ω–≥—ã—Ä!" },
                                { id: "bakanly", name: "–ë–ê“ö–ê–ù–õ–´", level: 3, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "–ë“ö", uran: "–ñ–∞—É—ã–Ω–≥—ã—Ä!" },
                                { id: "tyekli", name: "–¢–Ü–ï–ö–¢–Ü", level: 3, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "–¢–¢", uran: "–ñ–∞—É—ã–Ω–≥—ã—Ä!" },
                                { id: "yrgaqty", name: "–´–†“í–ê“ö–¢–´", level: 3, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "–´–†", uran: "–ñ–∞—É—ã–Ω–≥—ã—Ä!" },
                                { id: "baimaqty", name: "–ë–ê–ô–ú–ê“ö–¢–´", level: 3, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "–ë–ú", uran: "–ñ–∞—É—ã–Ω–≥—ã—Ä!" },
                                { id: "kazayakty", name: "“ö–ê–ó–ê–Ø“ö–¢–´", level: 3, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "“ö–ó", uran: "–ñ–∞—É—ã–Ω–≥—ã—Ä!" },
                                { id: "uygyr", name: "“∞–ô“í–´–†", level: 3, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "“∞–ô", uran: "–ñ–∞—É—ã–Ω–≥—ã—Ä!" }
                            ]
                        }
                    ]
                },
                {
                    id: "onTort",
                    name: "–ê–†–´–° –û–ù –¢”®–†–¢ –†–£",
                    level: 1,
                    type: "–ê—Ä—ã—Å",
                    tamga: "”ò—Ä—Ç“Ø—Ä–ª—ñ",
                    uran: "–£–ª–ª—ã —Ç–∞—û! / –¢–æ“õ—Å–∞–±–∞! / –®–∞—û–ª—ã-–®–∞—û—Ö–∞–π!",
                    info: {
                        history: "–û–Ω —Ç”©—Ä—Ç —Ä—É ‚Äî “õ–∞—Ä–∞“õ–∞–ª–ø–∞“õ–ª–∞—Ä–¥—ã“£ –µ–∫—ñ–Ω—à—ñ —ñ—Ä—ñ –∞—Ä—ã—Å—ã. 14 –Ω–µ–≥—ñ–∑–≥—ñ —Ä—É–¥–∞–Ω —Ç“±—Ä–∞–¥—ã.",
                        population: "–®–∞–º–∞–º–µ–Ω 60% “õ–∞—Ä–∞“õ–∞–ª–ø–∞“õ–ª–∞—Ä–¥—ã“£ “õ“±—Ä–∞–º—ã–Ω–¥–∞",
                        structure: "–ù–µ–≥—ñ–∑–≥—ñ —Ç–æ–ø—Ç–∞—Ä: “ö—ã—Ç–∞–π, “ö—ã–ø—à–∞“õ, –ö–µ–Ω–µ–≥–µ—Å, –ú–∞“£“ì—ã—Ç"
                    },
                    children: [
                        { id: "kytaƒ±", name: "“ö–´–¢–ê–ô", level: 2, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "Q", uran: "–£–ª–ª—ã —Ç–∞—û!" },
                        { id: "kypshak", name: "“ö–´–ü–®–ê“ö", level: 2, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "I", uran: "–¢–æ“õ—Å–∞–±–∞!" },
                        { id: "keneges", name: "–ö–ï–ù–ï–ì–ï–°", level: 2, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "X", uran: "–®–∞—û–ª—ã-–®–∞—û—Ö–∞–π!" },
                        { id: "mangyt", name: "–ú–ê“¢“í–´–¢", level: 2, type: "“Æ–ª–∫–µ–Ω —É—Ä—É—É", tamga: "f", uran: "–®–∞—û–ª—ã-–®–∞—û—Ö–∞–π!" }
                        // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏
                    ]
                }
            ]
        };

        // –§—É–Ω–∫—Ü–∏–∏ –ø–æ–∏—Å–∫–∞ —É–∑–ª–∞, —Ü–µ–ø–æ—á–∫–∏ —Ä–æ–¥–∏—Ç–µ–ª–µ–π –∏ —Ç.–¥. (–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ)
        function findNodeById(node, id) {
            if (node.id === id) return node;
            if (node.children) {
                for (let child of node.children) {
                    const found = findNodeById(child, id);
                    if (found) return found;
                }
            }
            return null;
        }

        function getParentChain(node, current = treeData, chain = []) {
            if (current.id === node.id) return [current, ...chain];
            if (current.children) {
                for (let child of current.children) {
                    const result = getParentChain(node, child, [current, ...chain]);
                    if (result) return result;
                }
            }
            return null;
        }

        function getAllDescendants(node) {
            let count = 0;
            if (node.children) {
                count += node.children.length;
                node.children.forEach(child => {
                    count += getAllDescendants(child);
                });
            }
            return count;
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–Ω–µ–ª—å—é
        function openPanel() {
            document.getElementById('infoPanel').classList.remove('collapsed');
            document.getElementById('infoPanel').classList.add('active');
            document.getElementById('openPanelBtn').classList.remove('visible');
            isPanelOpen = true;
        }

        function closePanel() {
            document.getElementById('infoPanel').classList.add('collapsed');
            document.getElementById('infoPanel').classList.remove('active');
            document.getElementById('openPanelBtn').classList.add('visible');
            isPanelOpen = false;
        }

        // –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞
        function buildAccordion(node, container, level = 0) {
            const item = document.createElement('div');
            item.className = 'accordion-item';
            item.id = 'accordion-' + node.id;

            const header = document.createElement('div');
            header.className = 'accordion-header level-' + level;
            header.innerHTML = `
                <span>${node.name} <span class="badge">${node.type || '–†—É'}</span></span>
                <span class="accordion-icon">‚ñº</span>
            `;

            const content = document.createElement('div');
            content.className = 'accordion-content';

            const inner = document.createElement('div');
            inner.className = 'accordion-inner';

            header.onclick = (e) => {
                e.stopPropagation();
                item.classList.toggle('active');
                showInfo(node);
            };

            if (node.children && node.children.length > 0) {
                node.children.forEach(child => {
                    if (child.children && child.children.length > 0) {
                        buildAccordion(child, inner, level + 1);
                    } else {
                        const subItem = document.createElement('div');
                        subItem.className = 'sub-item level-' + (level + 1);
                        subItem.innerHTML = `
                            <span class="name">${child.name}</span>
                            <span class="type">${child.type || '–†—É'}</span>
                        `;
                        subItem.onclick = (e) => {
                            e.stopPropagation();
                            showInfo(child);
                        };
                        subItem.id = 'item-' + child.id;
                        inner.appendChild(subItem);
                    }
                });
            }

            content.appendChild(inner);
            item.appendChild(header);
            item.appendChild(content);
            container.appendChild(item);
        }

        function showInfo(node) {
            currentSelectedNode = node;

            // –ü–æ–¥—Å–≤–µ—Ç–∫–∞
            document.querySelectorAll('.sub-item, .accordion-header').forEach(el => {
                el.classList.remove('highlight');
                el.style.border = '';
            });

            const item = document.getElementById('item-' + node.id);
            if (item) item.classList.add('highlight');

            const header = document.getElementById('accordion-' + node.id);
            if (header) header.querySelector('.accordion-header').style.border = '2px solid var(--gold)';

            openPanel();

            const content = document.getElementById('infoContent');
            let html = `
                <div class="info-header">
                    <div class="info-title">${node.name}</div>
                    <div class="info-type">${node.type || '–†—É'}</div>
                </div>`;

            // –¶–µ–ø–æ—á–∫–∞
            const chain = getParentChain(node);
            if (chain) {
                html += '<div class="info-section"><h3>üîó –¢–æ–ª—ã“õ —à–µ–∂—ñ—Ä–µ</h3><div class="hierarchy-chain">';
                chain.reverse().forEach((item, idx) => {
                    const isLast = idx === chain.length - 1;
                    html += `
                        <div class="hierarchy-item ${isLast ? 'current' : ''}">
                            <span class="hierarchy-level">${levelsMap[item.level]}</span>
                            <span>${item.name}</span>
                            ${!isLast ? '<span class="hierarchy-arrow">‚¨á</span>' : ''}
                        </div>`;
                });
                html += '</div></div>';
            }

            // –¢–∞–º–≥–∞ –∏ –£—Ä–∞–Ω
            if (node.tamga) {
                html += `
                    <div class="tamga-box">
                        <div class="tamga-symbol">${node.tamga}</div>
                        <div class="tamga-label">–¢–ê–ú“í–ê</div>
                    </div>`;
            }
            if (node.uran) {
                html += `
                    <div class="uran-box">
                        <div class="uran-text">${node.uran}</div>
                        <div class="uran-label">–£–†–ê–ù</div>
                    </div>`;
            }

            // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            if (node.info) {
                Object.entries(node.info).forEach(([key, value]) => {
                    if (value) {
                        const title = {
                            history: 'üìú –¢–∞—Ä–∏—Ö—ã',
                            origin: 'üß¨ –®—ã“ì—É —Ç–µ–≥—ñ',
                            legend: 'üåü –ê“£—ã–∑',
                            population: 'üë• –°–∞–Ω—ã',
                            structure: 'üèóÔ∏è “ö“±—Ä—ã–ª—ã–º—ã',
                            region: 'üåç –ê–π–º–∞“ì—ã'
                        }[key] || key;
                        html += `
                            <div class="info-section">
                                <h3>${title}</h3>
                                <p>${value}</p>
                            </div>`;
                    }
                });
            }

            // –ü–æ—Ç–æ–º–∫–∏
            const descendantsCount = getAllDescendants(node);
            if (descendantsCount > 0) {
                html += `
                    <div class="stats-box">
                        <div class="stats-number">${descendantsCount}</div>
                        <div>–¢—ñ–∫–µ–ª–µ–π “±—Ä–ø–∞“õ / –ü–æ–¥—á–∏–Ω—ë–Ω–Ω—ã–µ –≥—Ä—É–ø–ø—ã</div>
                    </div>`;
            }

            html += `
                <div class="info-section">
                    <h3>üìä –î”ô—Ä–µ–∂–µ</h3>
                    <p>${levelsMap[node.level]} (${node.level})</p>
                </div>`;

            content.innerHTML = html;
        }

        function searchAccordion() {
            const input = document.getElementById('searchInput').value.toLowerCase().trim();
            if (!input) return;

            document.querySelectorAll('.sub-item, .accordion-item').forEach(el => {
                el.classList.remove('highlight', 'active');
            });

            function searchRecursive(node) {
                let found = false;
                if (node.name.toLowerCase().includes(input)) {
                    found = true;
                    const item = document.getElementById('item-' + node.id) || document.getElementById('accordion-' + node.id);
                    if (item) {
                        item.classList.add('highlight');
                        item.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }
                if (node.children) {
                    node.children.forEach(child => {
                        if (searchRecursive(child)) {
                            found = true;
                            const parent = document.getElementById('accordion-' + node.id);
                            if (parent) parent.classList.add('active');
                        }
                    });
                }
                return found;
            }

            searchRecursive(treeData);
        }

        // –ë—É—Ä–≥–µ—Ä-–º–µ–Ω—é
        function toggleBurgerMenu() {
            document.getElementById('burgerMenu').classList.toggle('active');
            document.getElementById('viewSwitch').classList.toggle('active');
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            const accordion = document.getElementById('accordion');
            treeData.children.forEach(child => {
                buildAccordion(child, accordion, 1);
            });

            document.getElementById('closePanelBtn').addEventListener('click', closePanel);
            document.getElementById('openPanelBtn').addEventListener('click', () => {
                if (currentSelectedNode) openPanel();
                else alert('–ê–ª–¥—ã–º–µ–Ω –±—ñ—Ä —Ç—É—û–¥—ã —Ç–∞“£–ª–∞“£—ã–∑');
            });

            document.getElementById('burgerMenu').addEventListener('click', toggleBurgerMenu);
        });
    </script>
</body>
</html>