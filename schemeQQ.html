<!DOCTYPE html>
<html lang="kaa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URUW | Shema</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #d4af37;
            --bg: #0a0c10;
            --bg-card: #151923;
            --text: #ffffff;
            
            /* DÃ¡reje tÃºstleri */
            --tust-xaliq: #e74c3c;
            --tust-aris: #e67e22;
            --tust-bolim: #f1c40f;
            --tust-ulken: #2ecc71;
            --tust-uruw: #3498db;
            --tust-tiyre: #9b59b6;
            --tust-koshe: #1abc9c;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); overflow: hidden; }
        
        header {
            position: fixed;
            top: 0; left: 0; right: 0;
            background: rgba(10,12,16,0.95);
            border-bottom: 2px solid var(--gold);
            padding: 1rem 2rem;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            backdrop-filter: blur(10px);
            height: 70px;
        }

        .logo { display: flex; align-items: center; gap: 10px; }
        .logo h1 { font-family: 'Cormorant Garamond', serif; color: var(--gold); font-size: 1.8rem; }
        
        /* Burger menyu */
        .burger-menu {
            display: none;
            flex-direction: column;
            justify-content: space-around;
            width: 30px;
            height: 25px;
            background: transparent;
            border: none;
            cursor: pointer;
            padding: 0;
            z-index: 1001;
        }
        
        .burger-bar {
            width: 100%;
            height: 3px;
            background: var(--gold);
            border-radius: 2px;
            transition: all 0.3s ease;
        }
        
        .burger-menu.active .burger-bar:nth-child(1) {
            transform: rotate(45deg) translate(6px, 6px);
        }
        
        .burger-menu.active .burger-bar:nth-child(2) {
            opacity: 0;
        }
        
        .burger-menu.active .burger-bar:nth-child(3) {
            transform: rotate(-45deg) translate(6px, -6px);
        }
        
        .view-switch {
            display: flex;
            gap: 0.5rem;
            background: rgba(255,255,255,0.1);
            padding: 0.25rem;
            border-radius: 20px;
            transition: all 0.3s ease;
        }
        
        @media (max-width: 768px) {
            .burger-menu {
                display: flex;
            }
            
            .view-switch {
                position: fixed;
                top: 70px;
                left: 0;
                right: 0;
                background: rgba(10,12,16,0.98);
                flex-direction: column;
                align-items: center;
                padding: 1rem;
                border-bottom: 2px solid var(--gold);
                border-radius: 0;
                transform: translateY(-100%);
                opacity: 0;
                visibility: hidden;
            }
            
            .view-switch.active {
                transform: translateY(0);
                opacity: 1;
                visibility: visible;
            }
            
            .view-btn {
                max-width: 150px;
                text-align: center;
                padding: 1rem;
            }
        }
        
        .view-btn {
            padding: 0.5rem 1.5rem;
            border-radius: 16px;
            border: none;
            background: transparent;
            color: #8892b0;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            font-size: 0.9rem;
        }
        
        .view-btn:hover { color: white; background: rgba(255,255,255,0.1); }
        .view-btn.active { background: var(--gold); color: #000; font-weight: 600; }

        main {
    margin-top: 70px;
    height: calc(100vh - 70px);
    display: flex;
    position: relative;
}

#treeArea {
    flex: 1;
    overflow: hidden;
    position: relative;
    background: radial-gradient(circle at center, rgba(212,175,55,0.05) 0%, transparent 70%);
    cursor: grab;
}
        
        #treeArea:active { cursor: grabbing; }

        .node rect {
            cursor: pointer;
            transition: all 0.3s;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.5));
        }

        .node:hover rect {
            filter: drop-shadow(0 8px 12px rgba(0,0,0,0.6)) brightness(1.2);
            stroke: #fff;
            stroke-width: 3px;
        }

        .node text {
            font-family: 'Inter', sans-serif;
            font-size: 11px;
            font-weight: 600;
            fill: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.8);
            pointer-events: none;
        }
        
        .node .tamga-text {
            font-size: 14px;
            fill: #d4af37;
            font-weight: bold;
        }

        .link {
            fill: none;
            stroke: #4a5568;
            stroke-width: 2px;
            opacity: 0.6;
        }

        /* On panel */
        .detail-panel 
        {
    background: var(--bg-card);
    border-left: 1px solid #2d3548;
    padding: 2rem;
    overflow-y: auto;
    box-shadow: -10px 0 30px rgba(0,0,0,0.5);
    position: relative;
    transition: transform 0.3s ease, opacity 0.3s ease, visibility 0.3s, width 0.3s ease;
    width: 400px;
    flex-shrink: 0;
    }
        
        
    .detail-panel.collapsed 
    {
    transform: translateX(100%);
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
    width: 0;
    padding: 0;
    border: none;
    overflow: hidden;
    }
        
        .close-panel-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--tust-xaliq);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            transition: all 0.3s;
        }
        
        .close-panel-btn:hover {
            background: #c0392b;
            transform: scale(1.1);
        }
        
        .open-panel-btn {
            position: fixed;
            right: 20px;
            bottom: 100px;
            background: var(--gold);
            color: #000;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5em;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 999;
            box-shadow: 0 4px 15px rgba(241, 196, 15, 0.4);
            transition: all 0.3s;
        }
        
        .open-panel-btn.visible {
            display: flex;
        }
        
        .open-panel-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(241, 196, 15, 0.6);
        }

        .detail-header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid #2d3548;
        }

        .detail-tamga {
            width: 100px;
            height: 100px;
            margin: 0 auto 1rem;
            background: linear-gradient(135deg, rgba(212,175,55,0.2), rgba(212,175,55,0.1));
            border: 3px solid var(--gold);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            box-shadow: 0 0 30px rgba(212,175,55,0.3);
        }

        .detail-title { color: var(--gold); font-family: 'Cormorant Garamond', serif; font-size: 1.8rem; margin-bottom: 0.5rem; line-height: 1.2; }
        .detail-subtitle { color: #8892b0; font-size: 0.9rem; margin-bottom: 1rem; }
        
        .info-block {
            background: rgba(0,0,0,0.3);
            border-left: 4px solid var(--gold);
            padding: 1rem;
            border-radius: 0 8px 8px 0;
            margin-bottom: 1rem;
            transition: transform 0.2s;
        }
        
        .info-block:hover { transform: translateX(5px); }

        .info-label { font-size: 0.75rem; color: #8892b0; text-transform: uppercase; margin-bottom: 0.5rem; font-weight: bold; letter-spacing: 0.5px; }
        .info-content { color: #e2e8f0; line-height: 1.5; font-size: 0.95rem; }
        
        /* DÃ¡reje boyÄ±nsha tÃºster - tiykarÇµÄ± tÃºster */
        .node-xaliq rect { fill: var(--tust-xaliq); stroke: #c0392b; }
        .node-aris rect { fill: var(--tust-aris); stroke: #d35400; }
        .node-bolim rect { fill: var(--tust-bolim); stroke: #f39c12; }
        .node-ulken rect { fill: var(--tust-ulken); stroke: #27ae60; }
        .node-uruw rect { fill: var(--tust-uruw); stroke: #2980b9; }
        .node-tiyre rect { fill: var(--tust-tiyre); stroke: #8e44ad; }
        .node-koshe rect { fill: var(--tust-koshe); stroke: #16a085; }
        
        /* Bolim hÃ¡m Koshe ushÄ±n qara text */
        .node-bolim text,
        .node-koshe text { 
            fill: #000; 
            text-shadow: none; 
            font-weight: 700; 
        }
        
        .controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0,0,0,0.8);
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #333;
            display: flex;
            gap: 5px;
        }
        
        .controls button {
            background: #2d3748;
            border: none;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.2s;
        }
        
        .controls button:hover { background: var(--gold); color: black; }
        
        .legend-tree {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0,0,0,0.8);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #333;
            font-size: 0.8rem;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .legend-item { display: flex; align-items: center; gap: 8px; margin: 5px 0; }
        .legend-color { width: 12px; height: 12px; border-radius: 3px; }

        .lang-switch {
    display: flex;
    gap: 0.5rem;
    margin-left: 1rem;
    padding-left: 1rem;
    border-left: 1px solid rgba(212,175,55,0.3);
}

.lang-btn {
    padding: 0.4rem 0.8rem;
    border-radius: 8px;
    border: 1px solid var(--gold);
    background: transparent;
    color: var(--gold);
    cursor: pointer;
    font-size: 0.85rem;
    font-weight: 600;
    transition: all 0.3s;
    text-decoration: none;
}

.lang-btn:hover {
    background: rgba(212,175,55,0.1);
}

.lang-btn.active {
    background: var(--gold);
    color: #000;
}



    @media (max-width: 1200px) {
    main { display: block; }
    
    .detail-panel { 
        display: block;
        opacity: 0;
        visibility: hidden;
        position: fixed; 
        left: 0;
        right: 0;
        bottom: 0; 
        top: auto;
        width: 100%; 
        max-width: 100%;
        height: 70vh;
        max-height: 500px;
        z-index: 100; 
        transform: translateY(100%);
        transition: transform 0.3s ease, opacity 0.3s ease, visibility 0.3s;
        padding: 2rem;
        border-left: none;
        border-top: 2px solid var(--gold);
        border-radius: 20px 20px 0 0;
    }
    
    .detail-panel.active { 
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
    }
    
    .detail-panel.collapsed {
        transform: translateY(100%);
        width: 100%;
        padding: 2rem;
    }
    
    .open-panel-btn {
        bottom: 20px;
        right: 20px;
    }
    
    .close-panel-btn {
        top: 10px;
        right: 10px;
    }
}

@media (max-width: 768px) {
    .lang-switch {
        margin-left: 0;
        padding-left: 0;
        border-left: none;
        border-top: 1px solid rgba(212,175,55,0.3);
        padding-top: 0.5rem;
        margin-top: 0.5rem;
        justify-content: center;
    }
}
        
        /* Ierarxiya tizimi */
        .hierarchy-chain {
            background: linear-gradient(135deg, rgba(241, 196, 15, 0.1), rgba(230, 126, 34, 0.1));
            border: 2px solid var(--gold);
            border-radius: 8px;
            padding: 15px;
            margin: 12px 0;
        }
        .hierarchy-item {
            display: flex;
            align-items: center;
            padding: 6px 0;
            border-bottom: 1px dashed rgba(241, 196, 15, 0.3);
        }
        .hierarchy-item:last-child {
            border-bottom: none;
            font-weight: bold;
            color: var(--gold);
        }
        .hierarchy-arrow {
            margin: 0 10px;
            color: var(--tust-aris);
        }
        .hierarchy-level {
            background: var(--gold);
            color: #000;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7em;
            margin-right: 8px;
            min-width: 80px;
            text-align: center;
        }
    </style>
</head>
<body>
    <header>
        <div class="logo">
            <span style="font-size: 2rem;">ğŸŒ³</span>
            <h1>URUW</h1>
        </div>
        
        <button class="burger-menu" id="burgerMenu" aria-label="MenyunÄ± ashÄ±w">
            <span class="burger-bar"></span>
            <span class="burger-bar"></span>
            <span class="burger-bar"></span>
        </button>
        
        <div class="view-switch" id="viewSwitch">
            <a href="index.html" class="view-btn" target="_self">ğŸ  Bas bet</a>
            <a href="listsQQ.html" class="view-btn" target="_self">ğŸ“‹ Tizimler</a>
            <a href="schemeQQ.html" class="view-btn active" target="_self">ğŸŒ³ Sxema</a>
            <a href="exogamyQQ.html" class="view-btn" target="_self">ğŸ’‘ Ekzogamiya</a>
        </div>

        <div class="lang-switch">
    <a href="index.html" class="lang-btn active">QQ</a>
    <a href="indexKZ.html" class="lang-btn">KZ</a>
</div>
    </header>

    <main>
        <div id="treeArea">
            <svg id="treeSvg"></svg>
            <div class="legend-tree">
                <div style="color: var(--gold); margin-bottom: 8px; font-weight: bold;">Legenda:</div>
                <div class="legend-item"><div class="legend-color" style="background: var(--tust-xaliq);"></div> XalÄ±q</div>
                <div class="legend-item"><div class="legend-color" style="background: var(--tust-aris);"></div> ArÄ±s (QoÅ„Ä±rat/On tÃ³rt)</div>
                <div class="legend-item"><div class="legend-color" style="background: var(--tust-bolim);"></div> BÃ³lim</div>
                <div class="legend-item"><div class="legend-color" style="background: var(--tust-ulken);"></div> Ãšlken urÄ±w/UrÄ±w</div>
                <div class="legend-item"><div class="legend-color" style="background: var(--tust-uruw);"></div> Tiyre</div>
                <div class="legend-item"><div class="legend-color" style="background: var(--tust-tiyre);"></div> Ko'she</div>             
            </div>
            <div class="controls">
                <button onclick="ulÄ±wlastÄ±rÄ±w()" title="JaqtÄ±lastÄ±rÄ±w">+</button>
                <button onclick="qaÄ±taOrnatÄ±w()" title="QaÄ±ta ornatÄ±w">âŸ²</button>
                <button onclick="alqÄ±stÄ±rÄ±w()" title="AlqÄ±stÄ±rÄ±w">-</button>
            </div>z
        </div>

        <aside class="detail-panel collapsed" id="details">
            <button class="close-panel-btn" id="closePanelBtn" title="Paneldi jabÄ±w">Ã—</button>
            <div class="detail-header">
                <div class="detail-tamga" id="dTamga">ğŸ›ï¸</div>
                <div class="detail-title" id="dName">Qaraqalpaqlar</div>
                <div class="detail-subtitle" id="dSubtitle">Orta AziyadaÇµÄ± tÃºrk xalÄ±q</div>
            </div>
            <div id="dContent">
                <div class="info-block">
                    <div class="info-label">Navigatsiya</div>
                    <div class="info-content">
                        ğŸ–±ï¸ <strong>SÄ±ylÄ±q tegish</strong> â€” mÃ¡shtab<br>
                        âœ‹ <strong>TartÄ±p alÄ±w</strong> â€” jÄ±ljÄ±tÄ±w<br>
                        ğŸ‘† <strong>UruwÇµa basÄ±w</strong> â€” maÇµlÄ±wmat<br>
                    </div>
                </div>
            </div>
        </aside>
    </main>
    
    <button class="open-panel-btn" id="openPanelBtn" title="MaÇµlÄ±wmat panelin ashÄ±w">â„¹ï¸</button>

    <script>
        // TOLIQ QARAQALPAQ URUVLARI MAÇ´LIWMATLARI
        const terekMaÇµlÄ±wmatlarÄ± = {
            at: "Qaraqalpaqlar",
            tÃºri: "xaliq",
            tamga: "ğŸ›ï¸",
            maÇµlÄ±wmat: {
                tariyx: "Qaraqalpaqlar - Orta AziyadaÇµÄ± tÃºrk tilles xalÄ±q. XVI-XIII Ã¡sirlerde qalÄ±ptasqan.",
                tÃºbegi: "Negizi NoÇµay ordasÄ±, QÄ±pshaq, Qarluq taÄ±palarÄ±nan.",
                qalaqÄ±: "800 mÄ±Å„ adam",
                tili: "Qaraqalpaq tili - tÃºrk tilleriniÅ„ qÄ±pshaq tarmaÇµÄ±"
            },
            ballar: [
                {
                    at: "ArÄ±s QoÅ„Ä±rat",
                    tÃºri: "aris",
                    tamga: "P",
                    uran: "Qaqpa!",
                    maÇµlÄ±wmat: {
                        tariyx: "Eki iri arÄ±stÄ±Å„ biri. NoÇµay ordasÄ±nan.",
                        tÃºbegi: "NoÇµaylÄ±q, QÄ±pshaq taÄ±palarÄ±nÄ±Å„ qosÄ±ndÄ±sÄ±.",
                        qalaqÄ±: "9520 kibitok (40%)",
                        qurilimi: "ShulÄ±q (8 urÄ±w) hÃ¡m JauÄ±Å„ÇµÄ±r (7 urÄ±w)"
                    },
                    ballar: [
                        {
                            at: "ShulÄ±q bÃ³limi",
                            tÃºri: "bolim",
                            tamga: "Sh",
                            maÇµlÄ±wmat: { tariyx: "ShulÄ±q - 8 urÄ±wdan turadÄ±.", qalaqÄ±: "5860 kibitok" },
                            ballar: [
                                {
                                    at: "QÄ±yat",
                                    tÃºri: "ulken",
                                    tamga: "Î¨",
                                    uran: "Alataw!",
                                    maÇµlÄ±wmat: {
                                        tariyx: "QÄ±yat - ShulÄ±qtÄ±Å„ eÅ„ iri urÄ±wÄ±.",
                                        anÄ±z: "Ãšsh ulÄ±: ÃšshtaÅ„balÄ±, TaraqtÄ±, BalÇµalÄ±.",
                                        qalaqÄ±: "870 kibitok"
                                    },
                                    ballar: [
                                        {
                                            at: "ÃšshtaÅ„balÄ±",
                                            tÃºri: "uruw",
                                            tamga: "|||",
                                            maÇµlÄ±wmat: { tariyx: "Ãšsh taÅ„balÄ± - Ãºsh belgi." },
                                            ballar: [
                                                { at: "SaÅ„murÄ±n", tÃºri: "tiyre", maÇµlÄ±wmat: { tariyx: "SaÅ„ murÄ±ndÄ±q maldan" } },
                                                { at: "ArÄ±qqÄ±yat", tÃºri: "tiyre", maÇµlÄ±wmat: { tariyx: "ArÄ±q deneli" } },
                                                { at: "TartulÄ±", tÃºri: "tiyre" },
                                                { at: "QanjÄ±ÇµalÄ±", tÃºri: "tiyre" },
                                                { at: "QataÇµan", tÃºri: "tiyre" },
                                                { 
                                                    at: "QaraqÄ±yat", 
                                                    tÃºri: "tiyre",
                                                    ballar: [
                                                        { at: "Bolat", tÃºri: "koshe" },
                                                        { at: "Qarabas", tÃºri: "koshe" }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            at: "TaraqtÄ±",
                                            tÃºri: "uruw",
                                            maÇµlÄ±wmat: { tariyx: "ShashaqtÄ±, Ã³rnekti" },
                                            ballar: [
                                                { at: "ToÇµÄ±zaq", tÃºri: "tiyre", maÇµlÄ±wmat: { tariyx: "ToÇµÄ±z urpaqtan keyin" } },
                                                { at: "Abas", tÃºri: "tiyre" },
                                                { at: "JaltÄ±rshÄ±", tÃºri: "tiyre" },
                                                { at: "AqunqaraÇµan", tÃºri: "tiyre" },
                                                { at: "Taqay", tÃºri: "tiyre" },
                                                { at: "Qarjawbaras", tÃºri: "tiyre" }
                                            ]
                                        },
                                        {
                                            at: "BalÇµalÄ± QÄ±yat",
                                            tÃºri: "uruw",
                                            tamga: "B",
                                            maÇµlÄ±wmat: { tariyx: "BalÇµa ustagan. Temirshiler." },
                                            ballar: [
                                                { at: "BespÄ±shaq", tÃºri: "tiyre" },
                                                { at: "Etekshi", tÃºri: "tiyre" },
                                                { at: "SaÅ„murÄ±n", tÃºri: "tiyre" },
                                                { at: "QojaqqaraÇµan", tÃºri: "tiyre" }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    at: "AshamaylÄ±",
                                    tÃºri: "ulken",
                                    tamga: "âœ•",
                                    uran: "ShulÄ±q!",
                                    maÇµlÄ±wmat: { tariyx: "Ashamay - kÃ³zi nashar kÃ³retin.", qalaqÄ±: "870 kibitok" },
                                    ballar: [
                                        { at: "Saqu", tÃºri: "uruw", maÇµlÄ±wmat: { tariyx: "SaqshÄ±lar" } },
                                        { at: "Qaraqoja", tÃºri: "uruw" },
                                        { at: "JalaÅ„ayaq", tÃºri: "uruw", maÇµlÄ±wmat: { tariyx: "Tez jÃºgirwshi" } },
                                        { 
                                            at: "Qobasan", 
                                            tÃºri: "uruw",
                                            ballar: [
                                                { at: "Aqnazar", tÃºri: "tiyre" },
                                                { at: "JansarÄ±", tÃºri: "tiyre" },
                                                { at: "Ã“temis", tÃºri: "tiyre" },
                                                { at: "Esen", tÃºri: "tiyre" },
                                                { at: "TampÄ±sh", tÃºri: "tiyre" }
                                            ]
                                        },
                                        { at: "TÃºrkmenqara", tÃºri: "uruw", maÇµlÄ±wmat: { tariyx: "TÃºrkmenler men aralasqan" } },
                                        { at: "Jappar", tÃºri: "uruw" },
                                        { at: "SarÄ±", tÃºri: "uruw" },
                                        { at: "AbÄ±z", tÃºri: "uruw" },
                                        { at: "Aqay", tÃºri: "uruw" },
                                        { at: "PaÅ„qara", tÃºri: "uruw" },
                                        { at: "Ãšsh bas", tÃºri: "uruw" },
                                        { at: "Qurama", tÃºri: "uruw" }
                                    ]
                                },
                                {
                                    at: "QoldaulÄ±",
                                    tÃºri: "ulken",
                                    tamga: "Q",
                                    uran: "Qoldaw!",
                                    maÇµlÄ±wmat: { tariyx: "Qoldaw - opora.", qalaqÄ±: "1140 kibitok" },
                                    ballar: [
                                        { at: "Beskempir", tÃºri: "uruw", maÇµlÄ±wmat: { tariyx: "Bes kempir" } },
                                        { at: "MayshÄ±shalÄ±", tÃºri: "uruw" },
                                        { at: "Qalqaman", tÃºri: "uruw" },
                                        { at: "Ç´ayÄ±pqaraÇµan", tÃºri: "uruw", maÇµlÄ±wmat: { tariyx: "Ç´ayÄ±p bolÇµan ata" } },
                                        { at: "SarÄ±tan", tÃºri: "uruw" },
                                        { at: "KÃºlkÄ±qojaqq", tÃºri: "uruw" },
                                        { at: "JarÄ±mbet", tÃºri: "uruw" },
                                        { at: "QÄ±zÄ±layaq", tÃºri: "uruw" },
                                        { at: "QarasÄ±raq", tÃºri: "uruw" },
                                        { at: "JelqaraÇµan", tÃºri: "uruw" },
                                        { at: "ÃšlkenbÃ³rik", tÃºri: "uruw" },
                                        { at: "ShÄ±ljuÄ±t", tÃºri: "uruw" },
                                        { at: "JamanqoÅ„Ä±rat", tÃºri: "uruw" },
                                        { 
                                            at: "Qalmaq", 
                                            tÃºri: "uruw",
                                            ballar: [
                                                { at: "Adil", tÃºri: "tiyre" },
                                                { at: "Ereke", tÃºri: "tiyre" }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    at: "QostaÅ„balÄ±",
                                    tÃºri: "ulken",
                                    tamga: "â§‰",
                                    uran: "Qosqa!",
                                    maÇµlÄ±wmat: { tariyx: "Eki tamÇµalÄ±." },
                                    ballar: [
                                        { at: "Jangeldi", tÃºri: "uruw" },
                                        { at: "Shirjegen", tÃºri: "uruw" },
                                        { at: "AÇµabegli", tÃºri: "uruw" },
                                        { at: "QarÄ±njuan", tÃºri: "uruw" },
                                        { at: "QostaÅ„balÄ±", tÃºri: "uruw" },
                                        { at: "Qaraqursaq", tÃºri: "uruw" },
                                        { at: "QazaqÄ±", tÃºri: "uruw" }
                                    ]
                                },
                                {
                                    at: "BalÇµalÄ±",
                                    tÃºri: "ulken",
                                    tamga: "B",
                                    uran: "BalÇµa!",
                                    maÇµlÄ±wmat: { tariyx: "Temirshiler.", qalaqÄ±: "560 kibitok" },
                                    ballar: [
                                        { at: "AqbalÇµalÄ±", tÃºri: "uruw" },
                                        { at: "Nur balÇµalÄ±", tÃºri: "uruw" },
                                        { at: "TÃºrkmen", tÃºri: "uruw" },
                                        { at: "Jaman awÄ±l", tÃºri: "uruw" },
                                        { at: "ShÃ³mishti", tÃºri: "uruw" },
                                        { at: "ToqÄ±mbet", tÃºri: "uruw" },
                                        { at: "Taz balÇµalÄ±", tÃºri: "uruw" },
                                        { at: "QostamÇµalÄ±", tÃºri: "uruw" },
                                        { at: "QaratalshÄ±", tÃºri: "uruw" },
                                        { at: "Asan", tÃºri: "uruw" },
                                        { at: "ArzÄ±qul", tÃºri: "uruw" }
                                    ]
                                },
                                {
                                    at: "KÃ¡ndeĞºli",
                                    tÃºri: "ulken",
                                    tamga: "G",
                                    uran: "KÃ³ndek!",
                                    maÇµlÄ±wmat: { tariyx: "KÃ³ndek - qora.", qalaqÄ±: "730 kibitok" },
                                    ballar: [
                                        { at: "Qarama", tÃºri: "uruw" },
                                        { at: "Kiikshi", tÃºri: "uruw", maÇµlÄ±wmat: { tariyx: "Kiik saqshÄ±" } },
                                        { at: "Toqbolat", tÃºri: "uruw" },
                                        { at: "QÄ±rÄ±qsadaq", tÃºri: "uruw", maÇµlÄ±wmat: { tariyx: "40 sadaq" } }
                                    ]
                                },
                                {
                                    at: "QaramoyÄ±n",
                                    tÃºri: "ulken",
                                    tamga: "TM",
                                    uran: "MoyÄ±n!",
                                    maÇµlÄ±wmat: { tariyx: "Qara moyÄ±n.", qalaqÄ±: "560 kibitok" },
                                    ballar: [
                                        { at: "Annahoja", tÃºri: "uruw", maÇµlÄ±wmat: { tariyx: "Anna Ã¡wliye" } },
                                        { at: "Sabalaq", tÃºri: "uruw", maÇµlÄ±wmat: { tariyx: "Saba - bala" } },
                                        { at: "KÃ³telek", tÃºri: "uruw" },
                                        { at: "QarÄ±lmaral", tÃºri: "uruw" },
                                        { at: "BÃºlkildek", tÃºri: "uruw", maÇµlÄ±wmat: { tariyx: "KÃºlÃ½" } }
                                    ]
                                },
                                {
                                    at: "MÃºyten",
                                    tÃºri: "ulken",
                                    tamga: "Ïˆ",
                                    uran: "Aqsholpan!",
                                    maÇµlÄ±wmat: { 
                                        tariyx: "MoyÄ±n - moyÄ±n.", 
                                        anÄ±z: "MÃºytenniÅ„ Ãºsh ulÄ±: Samat, Teli, AbÄ±z",
                                        qalaqÄ±: "540 kibitok"
                                    },
                                    ballar: [
                                        { 
                                            at: "Samat", 
                                            tÃºri: "uruw",
                                            ballar: [
                                                { at: "BaybÃ­she", tÃºri: "tiyre" },
                                                { at: "ToqqaraÇµan", tÃºri: "tiyre" },
                                                { at: "Baymurat", tÃºri: "tiyre" },
                                                { at: "Jolan", tÃºri: "tiyre" },
                                                { at: "Bekaw", tÃºri: "tiyre" }
                                            ]
                                        },
                                        { 
                                            at: "Teli", 
                                            tÃºri: "uruw",
                                            ballar: [
                                                { at: "Tilewberdi", tÃºri: "tiyre" },
                                                { at: "Allaberdi", tÃºri: "tiyre" },
                                                { at: "TaÅ„irberdi", tÃºri: "tiyre" },
                                                { at: "MantÄ±qqaraÇµan", tÃºri: "tiyre" },
                                                { at: "MollaqqaraÇµan", tÃºri: "tiyre" }
                                            ]
                                        },
                                        { 
                                            at: "AbÄ±z", 
                                            tÃºri: "uruw",
                                            maÇµlÄ±wmat: { tariyx: "AqsaqĞ°Ğ», Ã¡wliye" },
                                            ballar: [
                                                { at: "AdÄ±", tÃºri: "tiyre" }
                                            ]
                                        },
                                        { 
                                            at: "KeÅ„tanaw", 
                                            tÃºri: "uruw",
                                            ballar: [
                                                { at: "Barn", tÃºri: "tiyre" },
                                                { at: "Itaq", tÃºri: "tiyre" },
                                                { at: "Jekensal", tÃºri: "tiyre" }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            at: "JauÄ±Å„ÇµÄ±r bÃ³limi",
                            tÃºri: "bolim",
                            maÇµlÄ±wmat: { tariyx: "JauÄ±Å„ÇµÄ±r - 7 urÄ±w.", qalaqÄ±: "3660 kibitok" },
                            ballar: [
                                {
                                    at: "TeristaÅ„balÄ±",
                                    tÃºri: "ulken",
                                    ballar: [
                                        { at: "Shomaq", tÃºri: "uruw" },
                                        { at: "Hangildi", tÃºri: "uruw" },
                                        { at: "BayqaraÇµan", tÃºri: "uruw" },
                                        { at: "Elshibay", tÃºri: "uruw" },
                                        { at: "Qurban", tÃºri: "uruw" },
                                        { at: "ToÇµÄ±z", tÃºri: "uruw" },
                                        { at: "Tile", tÃºri: "uruw" },
                                        { at: "Tebegen", tÃºri: "uruw" },
                                        { at: "Tum", tÃºri: "uruw" },
                                        { at: "TÃºrkistan", tÃºri: "uruw" }
                                    ]
                                },
                                {
                                    at: "BaqanlÄ±",
                                    tÃºri: "ulken",
                                    ballar: [
                                        { at: "TaÅ„mayÄ±l", tÃºri: "uruw" },
                                        { at: "Jaganay", tÃºri: "uruw" },
                                        { at: "Nayman", tÃºri: "uruw" },
                                        { at: "AyÄ±s", tÃºri: "uruw" }
                                    ]
                                },
                                {
                                    at: "TiyektÑ–",
                                    tÃºri: "ulken",
                                    ballar: [
                                        { at: "Shishi", tÃºri: "uruw", ballar: [{at:"Shishi Arna",tÃºri:"tiyre"}] },
                                        { at: "Tumanay", tÃºri: "uruw" },
                                        { at: "Mawlik", tÃºri: "uruw" },
                                        { at: "Bayram", tÃºri: "uruw" }
                                    ]
                                },
                                {
                                    at: "IrÇµaqtÄ±",
                                    tÃºri: "ulken",
                                    maÇµlÄ±wmat: { eskertpe: "Eki arÄ±sta da bar!" },
                                    ballar: [
                                        { at: "Atanay", tÃºri: "uruw" },
                                        { at: "Eshkili", tÃºri: "uruw" },
                                        { at: "Baybura", tÃºri: "uruw" },
                                        { at: "SarÄ±tan", tÃºri: "uruw" }
                                    ]
                                },
                                {
                                    at: "BaymaqtÄ±",
                                    tÃºri: "ulken",
                                    ballar: [
                                        { at: "Saspaq", tÃºri: "uruw" },
                                        { at: "Ãšyes", tÃºri: "uruw" },
                                        { at: "TaÅ„mayÄ±l", tÃºri: "uruw" },
                                        { at: "Jaganay", tÃºri: "uruw" }
                                    ]
                                },
                                {
                                    at: "QazayaqtÄ±",
                                    tÃºri: "ulken",
                                    ballar: [
                                        { at: "Anetay", tÃºri: "uruw" },
                                        { at: "JarÄ±mbet", tÃºri: "uruw" },
                                        { at: "Jundi", tÃºri: "uruw" },
                                        { at: "Sadaq", tÃºri: "uruw" }
                                    ]
                                },
                                {
                                    at: "UyÇµÄ±r",
                                    tÃºri: "ulken",
                                    ballar: [
                                        { at: "Shishi", tÃºri: "uruw" },
                                        { at: "Tumanay", tÃºri: "uruw" },
                                        { at: "Sabalaq", tÃºri: "uruw" },
                                        { at: "Mawlik", tÃºri: "uruw" },
                                        { at: "Bayram", tÃºri: "uruw" },
                                        { at: "SÄ±rÇµalÄ±", tÃºri: "uruw" }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    at: "ArÄ±s On tÃ³rt",
                    tÃºri: "aris",
                    tamga: "14",
                    uran: "Toqsaba!",
                    maÇµlÄ±wmat: {
                        tariyx: "14 urÄ±wdan ibarat iri arÄ±s. KÃ³p sanlÄ±.",
                        qalaqÄ±: "10260 kibitok (60%)",
                        qurilimi: "4 Ãºlken urÄ±w: QÄ±tay, QÄ±pshaq, Keneges, MaÅ„ÇµÄ±t"
                    },
                    ballar: [
                        {
                            at: "QÄ±tay",
                            tÃºri: "ulken",
                            tamga: "Q",
                            uran: "UllÄ± taw!",
                            jup: "QÄ±pshaq penen",
                            maÇµlÄ±wmat: { tariyx: "EÅ„ iri urÄ±w.", qalaqÄ±: "4320 kibitok" },
                            ballar: [
                                { at: "BessarÄ±", tÃºri: "uruw", ballar: [{at:"JÃºnli",tÃºri:"tiyre"},{at:"QoylÄ±",tÃºri:"tiyre"}] },
                                { at: "BeksÄ±yÄ±q", tÃºri: "uruw", ballar: [{at:"Zerger",tÃºri:"tiyre"},{at:"Masay",tÃºri:"tiyre"},{at:"ShÄ±ÇµÄ±rshÄ±",tÃºri:"tiyre"},{at:"Malay",tÃºri:"tiyre"}] },
                                { at: "QazayaqlÄ±", tÃºri: "uruw", ballar: [{at:"KÃ¡lsen",tÃºri:"tiyre"},{at:"KÃºyik",tÃºri:"tiyre"},{at:"MÄ±rzay",tÃºri:"tiyre"},{at:"QÄ±lmoyÄ±n",tÃºri:"tiyre"},{at:"JÄ±lqbay",tÃºri:"tiyre"}] },
                                { 
                                    at: "QayshÄ±lÄ±", 
                                    tÃºri: "uruw",
                                    ballar: [
                                        {at:"AqÄ±mbet",tÃºri:"tiyre"},
                                        {at:"Juwansan",tÃºri:"tiyre"},
                                        {at:"KÃ³terehoja",tÃºri:"tiyre"},
                                        {at:"TanamÄ±rza",tÃºri:"tiyre"},
                                        {at:"BaqÄ±",tÃºri:"tiyre"},
                                        {at:"SÄ±bÄ±l",tÃºri:"tiyre"},
                                        {at:"Basar",tÃºri:"tiyre"},
                                        {at:"TolÄ±q",tÃºri:"tiyre"},
                                        {at:"YabÄ±",tÃºri:"tiyre"}
                                    ]
                                },
                                { 
                                    at: "Ãyteke", 
                                    tÃºri: "uruw",
                                    ballar: [
                                        {at:"JÃ¡dik",tÃºri:"tiyre"},
                                        {at:"IrsÄ±mbek",tÃºri:"tiyre"},
                                        {at:"OrazÄ±mbet",tÃºri:"tiyre"},
                                        {at:"TaÅ„irkul",tÃºri:"tiyre"},
                                        {at:"Bektes",tÃºri:"tiyre",ballar:[{at:"Bektes TÃ³re",tÃºri:"koshe"}]},
                                        {at:"Nawriz",tÃºri:"tiyre"},
                                        {at:"ManjÃºwli",tÃºri:"tiyre"},
                                        {at:"TazshÄ±lÄ±q",tÃºri:"tiyre"}
                                    ]
                                },
                                { at: "ManjÃºwli", tÃºri: "uruw", ballar: [{at:"Eki shÄ±yÄ±q",tÃºri:"tiyre"},{at:"QaramanjÃºwli",tÃºri:"tiyre"},{at:"Ãyereke",tÃºri:"tiyre"}] },
                                { at: "Aralbay", tÃºri: "uruw", ballar: [{at:"Aqqala",tÃºri:"tiyre"},{at:"Qalmurat",tÃºri:"tiyre"},{at:"Ã“gizbayshÄ±",tÃºri:"tiyre"},{at:"BaybÃ­she",tÃºri:"tiyre"},{at:"Tilew qushÄ±",tÃºri:"tiyre"}] }
                            ]
                        },
                        {
                            at: "QÄ±pshaq",
                            tÃºri: "ulken",
                            tamga: "I",
                            uran: "Toqsaba!",
                            jup: "QÄ±tay penen",
                            maÇµlÄ±wmat: { tariyx: "KÃ³ne qÄ±pshaq urÄ±w.", qalaqÄ±: "2240 kibitok" },
                            ballar: [
                                { 
                                    at: "QaÅ„lÄ±", 
                                    tÃºri: "uruw",
                                    ballar: [
                                        {at:"Tram",tÃºri:"tiyre"},
                                        {at:"QatqaÅ„lÄ±",tÃºri:"tiyre"},
                                        {at:"IrÇµaqÄ±lÄ±",tÃºri:"tiyre"},
                                        {at:"AshamaylÄ±",tÃºri:"tiyre"},
                                        {at:"TaraqtÄ±",tÃºri:"tiyre"},
                                        {at:"Baspaq",tÃºri:"tiyre"},
                                        {at:"Ayat",tÃºri:"tiyre"},
                                        {at:"BosÄ±n",tÃºri:"tiyre"},
                                        {at:"Basapat",tÃºri:"tiyre"},
                                        {at:"QoÅ„Ä±rqazÄ±",tÃºri:"tiyre"},
                                        {at:"Kenes",tÃºri:"tiyre"},
                                        {at:"Tashkent",tÃºri:"tiyre"}
                                    ]
                                },
                                { at: "SaÅ„murÄ±n", tÃºri: "uruw", ballar: [{at:"KÃ³nshi",tÃºri:"tiyre"},{at:"Tubay",tÃºri:"tiyre"},{at:"Eshkili",tÃºri:"tiyre"},{at:"Jalpaq shek",tÃºri:"tiyre"},{at:"TÃ³lebay",tÃºri:"tiyre"},{at:"JabashÄ±",tÃºri:"tiyre"}] },
                                { at: "Estek", tÃºri: "uruw", ballar: [{at:"MaÅ„qanay",tÃºri:"tiyre"},{at:"QayÄ±pnazar",tÃºri:"tiyre"},{at:"Qaraterenshi",tÃºri:"tiyre"},{at:"Qalmurat",tÃºri:"tiyre"}] },
                                { at: "QanjÄ±ÇµalÄ±", tÃºri: "uruw", ballar: [{at:"ShanÄ±shpay",tÃºri:"tiyre"},{at:"Sambet",tÃºri:"tiyre"},{at:"JaÇµaltay",tÃºri:"tiyre"},{at:"BaybÃ­she",tÃºri:"tiyre"}] },
                                { at: "SaltÄ±r", tÃºri: "uruw", ballar: [{at:"BaybÃ­she",tÃºri:"tiyre"},{at:"Sart",tÃºri:"tiyre"},{at:"OrazÄ±mbet",tÃºri:"tiyre"},{at:"ShuyÄ±Çµan",tÃºri:"tiyre"}] }
                            ]
                        },
                        {
                            at: "Keneges",
                            tÃºri: "ulken",
                            tamga: "X",
                            uran: "ShawlÄ±-Shawhay!",
                            jup: "MaÅ„ÇµÄ±t penen",
                            maÇµlÄ±wmat: { tariyx: "Keneges.", qalaqÄ±: "1480 kibitok" },
                            ballar: [
                                { 
                                    at: "AranshÄ±", 
                                    tÃºri: "uruw",
                                    ballar: [
                                        {at:"Annaqul",tÃºri:"tiyre"},
                                        {at:"Abas",tÃºri:"tiyre",ballar:[{at:"Seytimbet",tÃºri:"koshe"}]},
                                        {at:"SÃºyin",tÃºri:"tiyre"},
                                        {at:"Juwas",tÃºri:"tiyre"},
                                        {at:"DÃ¡wletqarÇµa",tÃºri:"tiyre"},
                                        {at:"QayÄ±pbergen",tÃºri:"tiyre"}
                                    ]
                                },
                                { at: "AqtoÇµÄ±n", tÃºri: "uruw", ballar: [{at:"Nanjemes",tÃºri:"tiyre"},{at:"KÃ³shek",tÃºri:"tiyre"}] },
                                { at: "Ã“mir", tÃºri: "uruw", ballar: [{at:"AqpÄ±shaq",tÃºri:"tiyre"},{at:"Usaq",tÃºri:"tiyre"},{at:"Jel",tÃºri:"tiyre"},{at:"MÄ±njÄ±r",tÃºri:"tiyre"},{at:"Ã“temis",tÃºri:"tiyre"}] },
                                { at: "TaraqtÄ±", tÃºri: "uruw", ballar: [{at:"JetiqaraÇµaz",tÃºri:"tiyre",ballar:[{at:"Jetiqara",tÃºri:"koshe"}]}] },
                                { at: "Dobal", tÃºri: "uruw" },
                                { 
                                    at: "OymawÄ±t", 
                                    tÃºri: "uruw",
                                    ballar: [
                                        {at:"Qara",tÃºri:"tiyre"},
                                        {at:"SarÄ±",tÃºri:"tiyre",ballar:[{at:"Jiydeli",tÃºri:"koshe"}]},
                                        {at:"Aq",tÃºri:"tiyre"}
                                    ]
                                },
                                { at: "Dombazqaq", tÃºri: "uruw" },
                                { at: "NÃ³kis", tÃºri: "uruw", maÇµlÄ±wmat: { eskertpe: "Qaraqalpaqstan paytaxtÄ±!" }, ballar: [{at:"Jamanjaq",tÃºri:"tiyre"},{at:"Bozaq",tÃºri:"tiyre"},{at:"AltÄ±npÄ±shaq",tÃºri:"tiyre"},{at:"Ç´obdir",tÃºri:"tiyre"}] }
                            ]
                        },
                        {
                            at: "MaÅ„ÇµÄ±t",
                            tÃºri: "ulken",
                            tamga: "f",
                            uran: "ShawlÄ±-Shawhay!",
                            jup: "Keneges penen",
                            maÇµlÄ±wmat: { tariyx: "SoyÄ±sqor urÄ±w. Edige urpaqtarÄ±.", qalaqÄ±: "2220 kibitok" },
                            ballar: [
                                { 
                                    at: "Qaratay", 
                                    tÃºri: "uruw",
                                    maÇµlÄ±wmat: { topar: "Qara (Qaralar)" },
                                    ballar: [
                                        {at:"QaramaÅ„ÇµÄ±t",tÃºri:"tiyre",ballar:[{at:"Ãšshbas",tÃºri:"koshe"},{at:"QarasÄ±raq",tÃºri:"koshe"},{at:"AqmaÅ„ÇµÄ±t",tÃºri:"koshe"}]},
                                        {at:"MamÄ±qshÄ±",tÃºri:"tiyre",ballar:[{at:"Jetiqurt",tÃºri:"koshe"}]},
                                        {at:"Qosar",tÃºri:"tiyre",ballar:[{at:"GÃºbidin",tÃºri:"koshe"}]},
                                        {at:"QÄ±lqalÄ±",tÃºri:"tiyre"}
                                    ]
                                },
                                { 
                                    at: "SarÄ±tay", 
                                    tÃºri: "uruw",
                                    maÇµlÄ±wmat: { topar: "SarÄ± (SarÄ±lar)" },
                                    ballar: [
                                        {at:"ArshÄ±n",tÃºri:"tiyre"},
                                        {at:"JaylÄ±q",tÃºri:"tiyre"},
                                        {at:"ToqmaÅ„ÇµÄ±t",tÃºri:"tiyre"},
                                        {at:"ArsarÄ±",tÃºri:"tiyre"},
                                        {at:"TazjanlÄ±q",tÃºri:"tiyre"},
                                        {at:"ShÃºyt",tÃºri:"tiyre"},
                                        {at:"Jamansha",tÃºri:"tiyre"},
                                        {at:"Esebiy",tÃºri:"tiyre"},
                                        {at:"TamÇµalÄ±",tÃºri:"tiyre"},
                                        {at:"ToqmoyÄ±n",tÃºri:"tiyre"},
                                        {at:"Temirhoja",tÃºri:"tiyre"}
                                    ]
                                },
                                { at: "Boztay", tÃºri: "uruw", maÇµlÄ±wmat: { topar: "Boz (Bozlar)" }, ballar: [{at:"Bozta",tÃºri:"tiyre",ballar:[{at:"Bozta baba",tÃºri:"koshe"}]}] },
                                { at: "Jetimtay", tÃºri: "uruw", maÇµlÄ±wmat: { topar: "Jetim (Jetimler)" }, ballar: [{at:"EshbuÇµa",tÃºri:"tiyre",ballar:[{at:"Esh buÇµa",tÃºri:"koshe"}]}] }
                            ]
                        }
                    ]
                }
            ]
        };

        let svg, g, zoom;
        let Ã¡meldegiMasshtab = d3.zoomIdentity;
        let panelAshÄ±q = false;

        function terektiBaslaw() {
    const qorap = document.getElementById('treeArea');
    const keÅ„lik = qorap.clientWidth;
    const biyiklik = qorap.clientHeight;

    svg = d3.select("#treeSvg")
        .attr("width", keÅ„lik)
        .attr("height", biyiklik);

    // Tazalaw
    svg.selectAll("*").remove();

    zoom = d3.zoom()
        .scaleExtent([0.05, 3])
        .on("zoom", (e) => {
            g.attr("transform", e.transform);
            Ã¡meldegiMasshtab = e.transform;
        });

    svg.call(zoom);

    g = svg.append("g");

    // Ğ˜Ğ¡ĞŸĞ ĞĞ’Ğ›Ğ•ĞĞ˜Ğ• Ğ—Ğ”Ğ•Ğ¡Ğ¬:
    const tÃ¡mÄ±r = d3.hierarchy(terekMaÇµlÄ±wmatlarÄ±, d => d.ballar);
    
    // ĞÑÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ ĞºĞ¾Ğ´ Ğ±ĞµĞ· Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹...
    const japrakSanaqÄ± = tÃ¡mÄ±r.leaves().length;
    const terenlik = tÃ¡mÄ±r.height;
            
            // Kerek Ã³lshem
            const eÅ„AzamattÄ±qKeÅ„lik = Math.max(keÅ„lik, japrakSanaqÄ± * 25);
            const eÅ„AzamattÄ±qBiyiklik = Math.max(biyiklik, (terenlik + 1) * 100);
            
            const terekQurÄ±lmÄ± = d3.tree()
                .size([eÅ„AzamattÄ±qKeÅ„lik, eÅ„AzamattÄ±qBiyiklik])
                .separation((a, b) => {
                    if (a.parent === b.parent) return 1;
                    return 1.2;
                });
            
            terekQurÄ±lmÄ±(tÃ¡mÄ±r);

            // BaslanÇµÄ±sh kÃ³rinis - ortada
            const baslanÇµÄ±shMasshtab = Math.min(
                (keÅ„lik - 100) / eÅ„AzamattÄ±qKeÅ„lik,
                (biyiklik - 150) / eÅ„AzamattÄ±qBiyiklik,
                0.9
            );
            
            const baslanÇµÄ±shX = (keÅ„lik - eÅ„AzamattÄ±qKeÅ„lik * baslanÇµÄ±shMasshtab) / 2;
            const baslanÇµÄ±shY = 50;

            g.attr("transform", `translate(${baslanÇµÄ±shX}, ${baslanÇµÄ±shY}) scale(${baslanÇµÄ±shMasshtab})`);
            
            Ã¡meldegiMasshtab = d3.zoomIdentity
                .translate(baslanÇµÄ±shX, baslanÇµÄ±shY)
                .scale(baslanÇµÄ±shMasshtab);

            svg.call(zoom.transform, Ã¡meldegiMasshtab);

            // BaylanÄ±s sÄ±zÄ±qlarÄ±
            g.selectAll(".link")
                .data(tÃ¡mÄ±r.links())
                .enter().append("path")
                .attr("class", "link")
                .attr("d", d3.linkVertical()
                    .x(d => d.x)
                    .y(d => d.y));

            // BÃ³lekler
            const bÃ³lek = g.selectAll(".node")
                .data(tÃ¡mÄ±r.descendants())
                .enter().append("g")
                .attr("class", d => `node node-${d.data.tÃºri}`)
                .attr("transform", d => `translate(${d.x},${d.y})`)
                .on("click", (e, d) => maÇµlÄ±wmatKÃ³rsetiw(d.data));

            // TÃ³rtbÃºrÄ±shlar - kÃ³lemÄ± dÃ¡rejege qaray Ã³zgeredi
            bÃ³lek.append("rect")
                .attr("width", d => {
                    const uzÄ±nlÄ±q = Math.max(d.data.at.length * 7 + 16, 50);
                    return d.data.tÃºri === 'koshe' ? uzÄ±nlÄ±q * 0.8 : uzÄ±nlÄ±q;
                })
                .attr("height", d => d.data.tÃºri === 'koshe' ? 22 : 28)
                .attr("x", d => {
                    const uzÄ±nlÄ±q = Math.max(d.data.at.length * 7 + 16, 50);
                    const haqÄ±qÄ±yUzÄ±nlÄ±q = d.data.tÃºri === 'koshe' ? uzÄ±nlÄ±q * 0.8 : uzÄ±nlÄ±q;
                    return -haqÄ±qÄ±yUzÄ±nlÄ±q / 2;
                })
                .attr("y", d => d.data.tÃºri === 'koshe' ? -11 : -14)
                .attr("rx", 6)
                .attr("stroke-width", d => d.data.tÃºri === 'xaliq' ? 3 : 2);

            // Ataw mÃ¡tini
            bÃ³lek.append("text")
                .attr("dy", ".35em")
                .attr("text-anchor", "middle")
                .style("font-size", d => {
                    if (d.data.tÃºri === 'koshe') return "9px";
                    if (d.data.tÃºri === 'tiyre') return "10px";
                    return "11px";
                })
                .text(d => d.data.at);

            // TamÇµa (joqarÄ±da)
            bÃ³lek.filter(d => d.data.tamga && d.data.tÃºri !== 'koshe' && d.data.tÃºri !== 'tiyre')
                .append("text")
                .attr("class", "tamga-text")
                .attr("dy", -22)
                .attr("text-anchor", "middle")
                .text(d => d.data.tamga);
                
            // Uran (tÃ³mende)
            bÃ³lek.filter(d => d.data.uran && (d.data.tÃºri === 'aris' || d.data.tÃºri === 'ulken'))
                .append("text")
                .attr("dy", 28)
                .attr("text-anchor", "middle")
                .style("font-size", "9px")
                .style("fill", "#d4af37")
                .style("font-weight", "bold")
                .text(d => d.data.uran);
        }

        function maÇµlÄ±wmatKÃ³rsetiw(maÇµlÄ±wmat) {
            paneldiAshÄ±w();
            
            document.getElementById('dTamga').textContent = maÇµlÄ±wmat.tamga || (maÇµlÄ±wmat.tÃºri === 'aris' ? 'ğŸ›ï¸' : 'ğŸ¹');
            document.getElementById('dName').textContent = maÇµlÄ±wmat.at;
            
            let qospa = "";
            const tÃºrler = {
                'xaliq': 'XalÄ±q',
                'aris': 'ArÄ±s (plemennoje ob\'edineniye)',
                'bolim': 'BÃ³lim (bÃ³lme)',
                'ulken': 'Ãšlken urÄ±w (Ãºlken urÄ±w)',
                'uruw': 'UrÄ±w (urÄ±w)',
                'tiyre': 'Tiyre (tiyre)',
                'koshe': 'Ko\'she (bÃºtik)'
            };
            qospa = tÃºrler[maÇµlÄ±wmat.tÃºri] || 'RuwlÄ±q birlik';
            if (maÇµlÄ±wmat.maÇµlÄ±wmat && maÇµlÄ±wmat.maÇµlÄ±wmat.qalaqÄ±) qospa += ` â€¢ ${maÇµlÄ±wmat.maÇµlÄ±wmat.qalaqÄ±}`;
            document.getElementById('dSubtitle').textContent = qospa;
            
            let html = '';
            
            if (maÇµlÄ±wmat.uran) {
                html += `<div class="info-block" style="border-color:#e74c3c; background:rgba(231,76,60,0.1)">
                    <div class="info-label">SoyÄ±s urawÄ± (Uran)</div>
                    <div class="info-content" style="color:#ff8a80; font-size:1.3rem; font-weight:bold; text-align:center">${maÇµlÄ±wmat.uran}</div>
                </div>`;
            }
            
            if (maÇµlÄ±wmat.maÇµlÄ±wmat) {
                if (maÇµlÄ±wmat.maÇµlÄ±wmat.tariyx) {
                    html += `<div class="info-block">
                        <div class="info-label">TariyxÄ±</div>
                        <div class="info-content">${maÇµlÄ±wmat.maÇµlÄ±wmat.tariyx}</div>
                    </div>`;
                }
                if (maÇµlÄ±wmat.maÇµlÄ±wmat.tÃºbegi) {
                    html += `<div class="info-block" style="border-color:#3498db">
                        <div class="info-label">Kelip shÄ±ÇµÄ±wÄ±</div>
                        <div class="info-content">${maÇµlÄ±wmat.maÇµlÄ±wmat.tÃºbegi}</div>
                    </div>`;
                }
                if (maÇµlÄ±wmat.maÇµlÄ±wmat.anÄ±z) {
                    html += `<div class="info-block" style="border-color:#f39c12; background:rgba(243,156,18,0.1)">
                        <div class="info-label">AnÄ±z</div>
                        <div class="info-content"><em>${maÇµlÄ±wmat.maÇµlÄ±wmat.anÄ±z}</em></div>
                    </div>`;
                }
                if (maÇµlÄ±wmat.maÇµlÄ±wmat.qurilimi) {
                    html += `<div class="info-block" style="border-color:#27ae60">
                        <div class="info-label">Qurilimi</div>
                        <div class="info-content">${maÇµlÄ±wmat.maÇµlÄ±wmat.qurilimi}</div>
                    </div>`;
                }
                if (maÇµlÄ±wmat.maÇµlÄ±wmat.qalaqÄ±) {
                    html += `<div class="info-block" style="border-color:#9b59b6">
                        <div class="info-label">QalaqÄ±</div>
                        <div class="info-content">${maÇµlÄ±wmat.maÇµlÄ±wmat.qalaqÄ±}</div>
                    </div>`;
                }
                if (maÇµlÄ±wmat.maÇµlÄ±wmat.tili) {
                    html += `<div class="info-block">
                        <div class="info-label">Tili</div>
                        <div class="info-content">${maÇµlÄ±wmat.maÇµlÄ±wmat.tili}</div>
                    </div>`;
                }
                if (maÇµlÄ±wmat.maÇµlÄ±wmat.eskertpe) {
                    html += `<div class="info-block" style="border-color:#e67e22">
                        <div class="info-label">Eskertpe</div>
                        <div class="info-content">${maÇµlÄ±wmat.maÇµlÄ±wmat.eskertpe}</div>
                    </div>`;
                }
            }
            
            if (maÇµlÄ±wmat.ballar && maÇµlÄ±wmat.ballar.length > 0) {
                html += `<div class="info-block" style="border-color:#d4af37; text-align:center">
                    <div class="info-label">Toparlar sÃ¡ni</div>
                    <div class="info-content" style="font-size:1.5rem; color:var(--gold); font-weight:bold">${maÇµlÄ±wmat.ballar.length}</div>
                </div>`;
            }
            
            if (maÇµlÄ±wmat.jup) {
                html += `<div class="info-block" style="border-color:#3498db; background:rgba(52,152,219,0.1)">
                    <div class="info-label">Jupar urÄ±w</div>
                    <div class="info-content">${maÇµlÄ±wmat.jup}</div>
                </div>`;
            }
            
            document.getElementById('dContent').innerHTML = html || '<div class="info-block"><div class="info-label">MaÇµlÄ±wmat</div><div class="info-content">Basqa bÃ³leklerdi kÃ³riw ushÄ±n basÄ±Å„</div></div>';
        }

        function paneldiAshÄ±w() {
    const panel = document.getElementById('details');
    const ashÄ±wKnopkasÄ± = document.getElementById('openPanelBtn');
    
    panel.classList.remove('collapsed');
    panel.classList.add('active');
    ashÄ±wKnopkasÄ±.classList.remove('visible');
    panelAshÄ±q = true;
}

function paneldiJabÄ±w() {
    const panel = document.getElementById('details');
    const ashÄ±wKnopkasÄ± = document.getElementById('openPanelBtn');
    
    panel.classList.add('collapsed');
    panel.classList.remove('active');
    ashÄ±wKnopkasÄ±.classList.add('visible');
    panelAshÄ±q = false;
}

        function ulÄ±wlastÄ±rÄ±w() {
            svg.transition().duration(300).call(zoom.scaleBy, 1.3);
        }

        function alqÄ±stÄ±rÄ±w() {
            svg.transition().duration(300).call(zoom.scaleBy, 0.7);
        }

        function qaÄ±taOrnatÄ±w() {
            terektiBaslaw();
        }

        function burgerMenyunÄ±AynalÄ±stÄ±rÄ±w() {
            const burger = document.getElementById('burgerMenu');
            const kÃ³rinisAlmastÄ±rÇµÄ±sh = document.getElementById('viewSwitch');
            
            burger.classList.toggle('active');
            kÃ³rinisAlmastÄ±rÇµÄ±sh.classList.toggle('active');
        }

        window.onload = function() {
            terektiBaslaw();
            
            document.getElementById('burgerMenu').addEventListener('click', burgerMenyunÄ±AynalÄ±stÄ±rÄ±w);
            
            document.querySelectorAll('.view-btn').forEach(knopka => {
                knopka.addEventListener('click', function() {
                    if (window.innerWidth <= 768) {
                        burgerMenyunÄ±AynalÄ±stÄ±rÄ±w();
                    }
                });
            });
            
            document.getElementById('closePanelBtn').addEventListener('click', paneldiJabÄ±w);
            
            document.getElementById('openPanelBtn').addEventListener('click', paneldiAshÄ±w);
            
            // Ã“lshem Ã³zgergende qaÄ±ta qurÄ±w
            let keÅ„ = window.innerWidth;
            window.addEventListener('resize', function() {
                if (window.innerWidth !== keÅ„) {
                    keÅ„ = window.innerWidth;
                    setTimeout(terektiBaslaw, 100);
                }
            });
        };
    </script>
</body>
</html>