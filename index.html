<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—Ä—É—É ‚Äî –†–æ–¥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ä–∞–∫–∞–ª–ø–∞–∫–æ–≤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1e3a5f;
            --secondary: #d4a574;
            --accent: #c9a227;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --text: #f1f5f9;
            --text-muted: #94a3b8;
            --border: #334155;
            --gradient-1: linear-gradient(135deg, #1e3a5f 0%, #0f172a 100%);
            --gradient-2: linear-gradient(135deg, #d4a574 0%, #c9a227 100%);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-dark);
            color: var(--text);
            min-height: 100vh;
            line-height: 1.6;
        }

        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: 
                radial-gradient(ellipse at 20% 80%, rgba(30, 58, 95, 0.4) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 20%, rgba(212, 165, 116, 0.15) 0%, transparent 50%);
        }

        header {
            padding: 2rem 1rem;
            text-align: center;
        }

        .logo {
            font-size: 2.5rem;
            font-weight: 700;
            background: var(--gradient-2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: var(--text-muted);
            font-size: 1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .search-container {
            max-width: 800px;
            margin: 1rem auto;
            padding: 0 1rem;
        }

        .search-box {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 1rem;
            border: 1px solid var(--border);
        }

        .search-input-wrapper {
            display: flex;
            gap: 0.75rem;
            align-items: center;
            margin-bottom: 1rem;
        }

        .search-icon {
            width: 20px;
            height: 20px;
            color: var(--secondary);
            flex-shrink: 0;
        }

        #searchInput {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--text);
            font-size: 1rem;
            outline: none;
        }

        #searchInput::placeholder {
            color: var(--text-muted);
        }

        .search-filters {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            background: transparent;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 0.8rem;
        }

        .filter-btn.active, .filter-btn:hover {
            background: var(--secondary);
            color: var(--bg-dark);
            border-color: var(--secondary);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            max-width: 800px;
            margin: 1rem auto;
            padding: 0 1rem;
        }

        @media (min-width: 640px) {
            .stats { grid-template-columns: repeat(4, 1fr); }
        }

        .stat-card {
            background: var(--bg-card);
            padding: 1.25rem;
            border-radius: 12px;
            text-align: center;
            border: 1px solid var(--border);
        }

        .stat-number {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--secondary);
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.85rem;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem;
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        @media (min-width: 1024px) {
            .container { grid-template-columns: 1fr 380px; padding: 2rem; }
        }

        .tree-section {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 1.5rem;
            border: 1px solid var(--border);
        }

        .section-title {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .breadcrumb {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            font-size: 0.9rem;
        }

        .breadcrumb-item {
            color: var(--text-muted);
            cursor: pointer;
            padding: 0.25rem 0.5rem;
            border-radius: 6px;
        }

        .breadcrumb-item:hover {
            color: var(--secondary);
            background: rgba(212, 165, 116, 0.1);
        }

        .breadcrumb-item.active {
            color: var(--secondary);
            font-weight: 500;
        }

        .tree-container {
            overflow-x: auto;
        }

        .tree {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .tree-level {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .tree-node {
            background: var(--gradient-1);
            border: 2px solid var(--secondary);
            border-radius: 12px;
            padding: 1rem 1.25rem;
            min-width: 120px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            user-select: none;
        }

        .tree-node:active {
            transform: scale(0.95);
        }

        .tree-node:hover, .tree-node.active {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(212, 165, 116, 0.3);
            border-color: var(--accent);
        }

        .tree-node.active {
            background: var(--gradient-2);
            color: var(--bg-dark);
        }

        .tree-node .label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            opacity: 0.9;
            margin-bottom: 0.25rem;
        }

        .tree-node .name {
            font-size: 1rem;
            font-weight: 600;
        }

        .tree-node .count {
            font-size: 0.75rem;
            margin-top: 0.4rem;
            opacity: 0.8;
        }

        .branches {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 0.75rem;
            width: 100%;
        }

        .leaf-nodes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 0.5rem;
            width: 100%;
        }

        .back-btn {
            background: rgba(212, 165, 116, 0.15);
            border: 1px solid var(--secondary);
            color: var(--secondary);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            display: none;
            align-items: center;
            gap: 0.5rem;
        }

        .back-btn:hover {
            background: var(--secondary);
            color: var(--bg-dark);
        }

        .info-panel {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 1.5rem;
            border: 1px solid var(--border);
        }

        .info-header {
            text-align: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .info-icon {
            width: 60px;
            height: 60px;
            background: var(--gradient-2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 1.75rem;
        }

        .info-title {
            font-size: 1.25rem;
            margin-bottom: 0.25rem;
        }

        .info-type {
            color: var(--secondary);
            font-size: 0.85rem;
            text-transform: uppercase;
        }

        .info-item {
            margin-bottom: 1rem;
        }

        .info-item-label {
            color: var(--text-muted);
            font-size: 0.8rem;
            margin-bottom: 0.4rem;
            text-transform: uppercase;
        }

        .tag-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
        }

        .tag {
            background: rgba(212, 165, 116, 0.15);
            color: var(--secondary);
            padding: 0.3rem 0.7rem;
            border-radius: 16px;
            font-size: 0.8rem;
            border: 1px solid rgba(212, 165, 116, 0.3);
        }

        .search-results {
            max-width: 800px;
            margin: 1rem auto;
            padding: 0 1rem;
            display: none;
        }

        .search-results.active {
            display: block;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .close-search-btn {
            background: var(--bg-card);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
        }

        .result-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            border: 1px solid var(--border);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .result-card:hover {
            border-color: var(--secondary);
        }

        .result-icon {
            width: 48px;
            height: 48px;
            background: var(--gradient-1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            flex-shrink: 0;
        }

        .result-path {
            color: var(--text-muted);
            font-size: 0.8rem;
        }

        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--text-muted);
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>

    <header>
        <h1 class="logo">–£–†–£–£</h1>
        <p class="subtitle">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –±–∞–∑–∞ —Ä–æ–¥–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–∞—Ä–∞–∫–∞–ª–ø–∞–∫–æ–≤</p>
    </header>

    <div class="search-container">
        <div class="search-box">
            <div class="search-input-wrapper">
                <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
                <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫ —Ä–æ–¥–∞..." autocomplete="off">
            </div>
            <div class="search-filters">
                <button class="filter-btn active" data-filter="all">–í—Å–µ</button>
                <button class="filter-btn" data-filter="arys">–ê—Ä—ã—Å</button>
                <button class="filter-btn" data-filter="ulken">“Æ–ª–∫–µ–Ω —É—Ä—É—É</button>
                <button class="filter-btn" data-filter="uruu">–£—Ä—É—É</button>
                <button class="filter-btn" data-filter="tiyre">–¢–∏–π—Ä–µ</button>
            </div>
        </div>
    </div>

    <div class="stats">
        <div class="stat-card"><span class="stat-number">2</span><span class="stat-label">–ê—Ä—ã—Å–∞</span></div>
        <div class="stat-card"><span class="stat-number">6</span><span class="stat-label">“Æ–ª–∫–µ–Ω —É—Ä—É—É</span></div>
        <div class="stat-card"><span class="stat-number">300+</span><span class="stat-label">–£—Ä—É—É</span></div>
        <div class="stat-card"><span class="stat-number">‚àû</span><span class="stat-label">–ö”©—à–µ</span></div>
    </div>

    <div class="search-results" id="searchResults">
        <div class="results-header">
            <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞</h3>
            <button class="close-search-btn" onclick="closeSearch()">‚úï –ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
        <div id="resultsList"></div>
    </div>

    <div class="container" id="mainContent">
        <div class="tree-section">
            <h2 class="section-title"><span>üå≥</span>–ò–µ—Ä–∞—Ä—Ö–∏—è —Ä–æ–¥–æ–≤</h2>
            <div class="breadcrumb" id="breadcrumb">
                <span class="breadcrumb-item active" onclick="goHome()">–í—Å–µ –∞—Ä—ã—Å—ã</span>
            </div>
            <button class="back-btn" id="backBtn" onclick="goBack()">‚Üê –ù–∞–∑–∞–¥</button>
            <div class="tree-container">
                <div class="tree" id="treeView"></div>
            </div>
        </div>

        <div class="info-panel" id="infoPanel">
            <div class="info-header">
                <div class="info-icon">üèõÔ∏è</div>
                <h3 class="info-title">–ö–∞—Ä–∞–∫–∞–ª–ø–∞–∫–∏</h3>
                <p class="info-type">–ù–∞—Ä–æ–¥</p>
            </div>
            <div class="info-content">
                <div class="info-item">
                    <div class="info-item-label">–û–ø–∏—Å–∞–Ω–∏–µ</div>
                    <div class="info-item-value">–¢—é—Ä–∫–æ—è–∑—ã—á–Ω—ã–π –Ω–∞—Ä–æ–¥, –ø—Ä–æ–∂–∏–≤–∞—é—â–∏–π –≤ –†–µ—Å–ø—É–±–ª–∏–∫–µ –ö–∞—Ä–∞–∫–∞–ª–ø–∞–∫—Å—Ç–∞–Ω.</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –î–∞–Ω–Ω—ã–µ –æ —Ä–æ–¥–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
        const uruuData = {
            id: 'root',
            name: '–ö–∞—Ä–∞–∫–∞–ª–ø–∞–∫–∏',
            type: 'root',
            description: '–¢—é—Ä–∫–æ—è–∑—ã—á–Ω—ã–π –Ω–∞—Ä–æ–¥, –ø—Ä–æ–∂–∏–≤–∞—é—â–∏–π –≤ –†–µ—Å–ø—É–±–ª–∏–∫–µ –ö–∞—Ä–∞–∫–∞–ª–ø–∞–∫—Å—Ç–∞–Ω',
            children: [
                {
                    id: 'konyrat',
                    name: '“ö–æ“£—ã—Ä–∞—Ç',
                    type: 'arys',
                    literal: '–û–≥–ª–æ–±–ª—è / –ö—Ä—ã–ª–æ',
                    description: '–û–¥–∏–Ω –∏–∑ –¥–≤—É—Ö –∫—Ä—É–ø–Ω—ã—Ö –∞—Ä—ã—Å–æ–≤. –î–µ–ª–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–æ —Å –ø–æ–ª–∏—Ç–∏–∫–æ–π –°–µ–π–¥-–ú—É—Ö–∞–º–º–µ–¥—Ö–∞–Ω–∞ (–ø–æ—Å–ª–µ 1855-1856 –≥–≥.)',
                    children: [
                        { 
                            id: 'kyyat', 
                            name: '“ö—ã—è—Ç', 
                            type: 'ulken',
                            children: [
                                { 
                                    id: 'kyyat-u', 
                                    name: '“ö—ã—è—Ç', 
                                    type: 'uruu',
                                    children: [
                                        { name: '–¢–∏–π—Ä–µ 1', type: 'tiyre' },
                                        { name: '–¢–∏–π—Ä–µ 2', type: 'tiyre' }
                                    ]
                                }
                            ]
                        },
                        { 
                            id: 'ashamayly', 
                            name: '–ê—à–∞–º–∞–π–ª—ã', 
                            type: 'ulken',
                            tamga: '–î–≤–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏–µ—Å—è –ª–∏–Ω–∏–∏',
                            tamgaNote: '–ò–¥–µ–Ω—Ç–∏—á–Ω–∞ —Ç–∞–º–≥–µ –∫–∞–∑–∞—Ö—Å–∫–æ–≥–æ —Ä–æ–¥–∞ –∫–µ—Ä–µ–∏',
                            children: [
                                { 
                                    id: 'ashamayly-u', 
                                    name: '–ê—à–∞–º–∞–π–ª—ã', 
                                    type: 'uruu',
                                    children: [
                                        { name: '–ü–∞–Ω“õ–∞—Ä–∞', type: 'tiyre' },
                                        { name: '–î—Ä—É–≥–∏–µ —Ç–∏–π—Ä–µ', type: 'tiyre' }
                                    ]
                                }
                            ]
                        },
                        { 
                            id: 'koydauly', 
                            name: '“ö–æ–ª–¥–∞—É–ª—ã', 
                            type: 'ulken',
                            children: [
                                { 
                                    id: 'koydauly-u', 
                                    name: '“ö–æ–ª–¥–∞—É–ª—ã', 
                                    type: 'uruu',
                                    exogamyNote: '–ü–∞—Ä–Ω—ã–µ: –°–∞—Ä—ã—Ç–æ–Ω ‚Üî –ö“Ø–ª–∫–∏—Ö–æ–∂–∞“õ',
                                    children: [
                                        { name: '–°–∞—Ä—ã—Ç–æ–Ω', type: 'tiyre', cemetery: '–®—ã—Ç–ª—ã' },
                                        { name: '–ö“Ø–ª–∫–∏—Ö–æ–∂–∞“õ', type: 'tiyre' },
                                        { name: '“ö–∞–ª–º–∞“õ', type: 'tiyre' },
                                        { name: '“Æ–ª–∫–µ–Ω–±”©—Ä–∏–∫', type: 'tiyre' }
                                    ]
                                }
                            ]
                        },
                        { id: 'kostamgaly', name: '“ö–æ—Å—Ç–∞–º“ì–∞–ª—ã', type: 'ulken', children: [] },
                        { id: 'balgaly', name: '–ë–∞–ª“ì–∞–ª—ã', type: 'ulken', children: [] },
                        { id: 'kandekli', name: '“ö–∞–Ω–¥–µ–∫–ª–∏', type: 'ulken', children: [] },
                        { 
                            id: 'karamoyyn', 
                            name: '“ö–∞—Ä–∞–º–æ–π—ã–Ω', 
                            type: 'ulken',
                            note: '–ü—Ä–æ–∂–∏–≤–∞–µ—Ç –≤ –∞—É–ª–µ –ë”©–≥–µ–∂–µ–∏ÃÜ–ª–∏',
                            children: [] 
                        },
                        { 
                            id: 'muyten', 
                            name: '–ú“Ø–∏ÃÜ—Ç–µ–Ω', 
                            type: 'ulken',
                            history: '–î—Ä–µ–≤–Ω–∏–π —Ä–æ–¥, –ø–∞—Ä–Ω—ã–π —Å “ö–æ“£—ã—Ä–∞—Ç',
                            cemetery: '“ö–∞–±–∞“õ–ª—ã –∞—Ç–∞, –¢–µ—Ä–±–µ–Ω–±–µ—Å',
                            children: [] 
                        },
                        { 
                            id: 'teristamgaly', 
                            name: '–¢–µ—Ä–∏—Å—Ç–∞–º“ì–∞–ª—ã', 
                            type: 'ulken',
                            note: '–ê—É–ª –∏–∑ 15 –¥–æ–º–æ–≤ ‚Äî —á–∏—Å—Ç–æ —Ä–æ–¥–æ–≤–æ–µ –ø–æ—Å–µ–ª–µ–Ω–∏–µ',
                            children: [
                                { 
                                    id: 'teristamgaly-u', 
                                    name: '–¢–µ—Ä–∏—Å—Ç–∞–º“ì–∞–ª—ã', 
                                    type: 'uruu',
                                    location: '–ö–∞—Ä–∞—É–∑—è–∫—Å–∫–∏–π —Ä–∞–π–æ–Ω',
                                    structure: '–¢–∏–π—Ä–µ –®–æ–º–∞“õ (3-4 –ø–æ–∫–æ–ª–µ–Ω–∏—è)',
                                    children: [
                                        { name: '–®–æ–º–∞“õ', type: 'tiyre' },
                                        { name: '–¢–æ“ì–∞–∏ÃÜ', type: 'tiyre' }
                                    ]
                                }
                            ]
                        },
                        { id: 'bakanaly', name: '–ë–∞“õ–∞–Ω–∞–ª—ã-–®–∞—É–∂–µ–∏ÃÜ–ª–∏', type: 'ulken', children: [] },
                        { id: 'tiyekli', name: '–¢–∏–π–µ–∫–ª–∏', type: 'ulken', children: [] },
                        { 
                            id: 'yrgakly', 
                            name: '–´—Ä“ì–∞“õ–ª—ã', 
                            type: 'ulken',
                            note: '–í—Ö–æ–¥–∏—Ç –≤ –æ–±–∞ –∞—Ä—ã—Å–∞!',
                            children: [
                                { 
                                    id: 'yrgakly-s', 
                                    name: '–´—Ä“ì–∞“õ–ª—ã-–°–∞—Ä—ã—Ç–æ–Ω', 
                                    type: 'uruu',
                                    legend: '–õ–µ–≥–µ–Ω–¥–∞ –æ –ø–∞—Ä–µ, –∏–∑–≥–Ω–∞–Ω–Ω–æ–π –∑–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–µ —ç–∫–∑–æ–≥–∞–º–∏–∏',
                                    children: [
                                        { name: '–°–∞—Ä—ã—Ç–æ–Ω', type: 'tiyre' },
                                        { name: '–ï—à–∫–∏–ª–∏', type: 'tiyre' },
                                        { name: '–ë–∞–π–±—É—Ä–∞', type: 'tiyre', cemetery: '–¢–∞–º–¥—ã–∫—É–º' },
                                        { name: '–ê—Ç–∞–Ω–∞–∏ÃÜ', type: 'tiyre', cemetery: '–û—Ä–∞–∑–±–∞–π' }
                                    ]
                                }
                            ]
                        },
                        { id: 'baymakly', name: '–ë–∞–π–º–∞“õ–ª—ã', type: 'ulken', children: [] },
                        { id: 'kazayakly', name: '“ö–∞–∑–∞—è“õ–ª—ã', type: 'ulken', children: [] },
                        { id: 'uygyr', name: '–£–∏ÃÜ“ì—ã—Ä', type: 'ulken', children: [] }
                    ]
                },
                {
                    id: 'on-tort',
                    name: '–û–Ω —Ç”©—Ä—Ç —É—Ä—É—É',
                    type: 'arys',
                    literal: '–ß–µ—Ç—ã—Ä–Ω–∞–¥—Ü–∞—Ç—å —Ä–æ–¥–æ–≤',
                    description: '–í—Ç–æ—Ä–æ–π –∫—Ä—É–ø–Ω—ã–π –∞—Ä—ã—Å',
                    history: '–î–æ XIX –≤–µ–∫–∞ ‚Äî 6 –∫—Ä—É–ø–Ω—ã—Ö —É—Ä—É—É –≤ 3 –ø–∞—Ä–∞—Ö',
                    children: [
                        { 
                            id: 'ktay', 
                            name: '“ö—Ç–∞–∏ÃÜ', 
                            type: 'ulken',
                            history: '–î—Ä–µ–≤–Ω–∏–π —Ä–æ–¥, –ø–∞—Ä–Ω—ã–π —Å “ö—ã–ø—à–∞“õ',
                            pair: '“ö—ã–ø—à–∞“õ',
                            children: [
                                { 
                                    id: 'ktay-u', 
                                    name: '“ö—Ç–∞–∏ÃÜ', 
                                    type: 'uruu',
                                    children: [
                                        { name: '–ë–µ—Å—Å–∞—Ä—ã', type: 'tiyre' },
                                        { name: '–ê–∏ÃÜ—Ç–µ–∫–µ—à–µ—Ä–∏—É–∏ÃÜ—à–∏', type: 'tiyre', exogamy: '–≠–∫–∑–æ–≥–∞–º–Ω—ã —Å –ê–Ω–Ω–∞-“õ—É–∏ÃÜ—ã–Ω' },
                                        { name: '–ê–Ω–Ω–∞-“õ—É–∏ÃÜ—ã–Ω', type: 'tiyre' }
                                    ]
                                }
                            ]
                        },
                        { id: 'kypshak', name: '“ö—ã–ø—à–∞“õ', type: 'ulken', pair: '“ö—Ç–∞–∏ÃÜ', children: [] },
                        { id: 'keneges', name: '–ö–µ–Ω–µ–≥–µ—Å', type: 'ulken', pair: '–ú–∞–Ω“ì—ã—Ç', children: [] },
                        { id: 'mangyt', name: '–ú–∞–Ω“ì—ã—Ç', type: 'ulken', pair: '–ö–µ–Ω–µ–≥–µ—Å', children: [] }
                    ]
                }
            ]
        };

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let navigationStack = ['root'];
        let currentFilter = 'all';
        let flatData = [];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            flattenData(uruuData);
            renderTree('root');
            setupSearch();
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–æ—Å–∫–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞
        function flattenData(node, path) {
            path = path || [];
            const currentPath = path.concat(node);
            flatData.push({
                id: node.id,
                name: node.name,
                type: node.type,
                pathNames: currentPath.map(p => p.name).join(' ‚Üí ')
            });
            if (node.children) {
                node.children.forEach(child => flattenData(child, currentPath));
            }
        }

        // –ü–æ–∏—Å–∫ —É–∑–ª–∞ –ø–æ ID
        function findNode(id) {
            function search(node) {
                if (node.id === id) return node;
                if (node.children) {
                    for (let i = 0; i < node.children.length; i++) {
                        const found = search(node.children[i]);
                        if (found) return found;
                    }
                }
                return null;
            }
            return search(uruuData);
        }

        // –ü–æ–ª—É—á–∏—Ç—å –ø—É—Ç—å –∫ —É–∑–ª—É
        function getPath(id) {
            const path = [];
            function build(node, target) {
                path.push(node);
                if (node.id === target) return true;
                if (node.children) {
                    for (let i = 0; i < node.children.length; i++) {
                        if (build(node.children[i], target)) return true;
                    }
                }
                path.pop();
                return false;
            }
            build(uruuData, id);
            return path;
        }

        // –†–µ–Ω–¥–µ—Ä –¥–µ—Ä–µ–≤–∞
        function renderTree(nodeId) {
            const node = findNode(nodeId);
            if (!node) return;

            const treeView = document.getElementById('treeView');
            treeView.innerHTML = '';

            // –¢–µ–∫—É—â–∏–π —É–∑–µ–ª
            const currentLevel = document.createElement('div');
            currentLevel.className = 'tree-level';
            currentLevel.appendChild(createNode(node, true));
            treeView.appendChild(currentLevel);

            // –î–µ—Ç–∏
            if (node.children && node.children.length > 0) {
                const childrenLevel = document.createElement('div');
                childrenLevel.className = 'tree-level';
                
                const container = document.createElement('div');
                container.className = (node.type === 'arys' || node.type === 'root') ? 'branches' : 'leaf-nodes';
                
                for (let i = 0; i < node.children.length; i++) {
                    container.appendChild(createNode(node.children[i], false));
                }
                
                childrenLevel.appendChild(container);
                treeView.appendChild(childrenLevel);
            }

            updateBreadcrumb(nodeId);
            updateInfoPanel(node);
            
            // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É –Ω–∞–∑–∞–¥
            const backBtn = document.getElementById('backBtn');
            backBtn.style.display = navigationStack.length > 1 ? 'inline-flex' : 'none';
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ —É–∑–ª–∞
        function createNode(node, isActive) {
            const div = document.createElement('div');
            div.className = 'tree-node' + (isActive ? ' active' : '');
            div.onclick = function() { handleNodeClick(node.id); };
            
            const labels = {
                root: '–ù–∞—Ä–æ–¥',
                arys: '–ê—Ä—ã—Å',
                ulken: '“Æ–ª–∫–µ–Ω —É—Ä—É—É',
                uruu: '–£—Ä—É—É',
                tiyre: '–¢–∏–π—Ä–µ'
            };

            let html = '<div class="label">' + (labels[node.type] || node.type) + '</div>';
            html += '<div class="name">' + node.name + '</div>';
            if (node.children && node.children.length > 0) {
                html += '<div class="count">' + node.children.length + ' –ø–æ–¥–≥—Ä—É–ø–ø</div>';
            }
            div.innerHTML = html;
            return div;
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ —É–∑–ª—É
        function handleNodeClick(id) {
            if (id === navigationStack[navigationStack.length - 1]) return;
            navigationStack.push(id);
            renderTree(id);
        }

        // –ù–∞–∑–∞–¥
        function goBack() {
            if (navigationStack.length > 1) {
                navigationStack.pop();
                renderTree(navigationStack[navigationStack.length - 1]);
            }
        }

        // –î–æ–º–æ–π
        function goHome() {
            navigationStack = ['root'];
            renderTree('root');
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ö–ª–µ–±–Ω—ã—Ö –∫—Ä–æ—à–µ–∫
        function updateBreadcrumb(nodeId) {
            const path = getPath(nodeId);
            const bc = document.getElementById('breadcrumb');
            let html = '';
            for (let i = 0; i < path.length; i++) {
                const isLast = i === path.length - 1;
                const onclick = isLast ? '' : 'onclick="jumpTo(\'' + path[i].id + '\')"';
                const cls = isLast ? 'active' : '';
                html += '<span class="breadcrumb-item ' + cls + '" ' + onclick + '>' + path[i].name + '</span>';
                if (!isLast) html += '<span class="breadcrumb-separator">‚Ä∫</span>';
            }
            bc.innerHTML = html;
        }

        // –ü—Ä—ã–∂–æ–∫ –∫ —É–∑–ª—É
        function jumpTo(id) {
            const idx = navigationStack.indexOf(id);
            if (idx !== -1) {
                navigationStack = navigationStack.slice(0, idx + 1);
            } else {
                navigationStack = [id];
            }
            renderTree(id);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ-–ø–∞–Ω–µ–ª–∏
        function updateInfoPanel(node) {
            const panel = document.getElementById('infoPanel');
            const icons = {
                root: 'üèõÔ∏è', arys: 'ü¶Ö', ulken: 'üå≥', 
                uruu: 'üèòÔ∏è', tiyre: 'üè†'
            };
            const types = {
                root: '–ù–∞—Ä–æ–¥', arys: '–ê—Ä—ã—Å (–∫—Ä—ã–ª–æ)', 
                ulken: '“Æ–ª–∫–µ–Ω —É—Ä—É—É', uruu: '–£—Ä—É—É (—Ä–æ–¥)', 
                tiyre: '–¢–∏–π—Ä–µ'
            };

            let html = '<div class="info-header">';
            html += '<div class="info-icon">' + (icons[node.type] || 'üìã') + '</div>';
            html += '<h3 class="info-title">' + node.name + '</h3>';
            html += '<p class="info-type">' + (types[node.type] || node.type) + '</p>';
            html += '</div><div class="info-content">';

            if (node.literal) {
                html += '<div class="info-item"><div class="info-item-label">–ó–Ω–∞—á–µ–Ω–∏–µ</div><div class="info-item-value">' + node.literal + '</div></div>';
            }
            if (node.description) {
                html += '<div class="info-item"><div class="info-item-label">–û–ø–∏—Å–∞–Ω–∏–µ</div><div class="info-item-value">' + node.description + '</div></div>';
            }
            if (node.history) {
                html += '<div class="info-item"><div class="info-item-label">–ò—Å—Ç–æ—Ä–∏—è</div><div class="info-item-value">' + node.history + '</div></div>';
            }
            if (node.tamga) {
                html += '<div class="info-item"><div class="info-item-label">–¢–∞–º–≥–∞</div><div class="info-item-value">‚úï ' + node.tamga;
                if (node.tamgaNote) html += '<br><small style="color:var(--text-muted)">' + node.tamgaNote + '</small>';
                html += '</div></div>';
            }
            if (node.pair) {
                html += '<div class="info-item"><div class="info-item-label">–ü–∞—Ä–Ω—ã–π —Ä–æ–¥</div><div class="info-item-value">üîó ' + node.pair + '</div></div>';
            }
            if (node.cemetery) {
                html += '<div class="info-item"><div class="info-item-label">–ö–ª–∞–¥–±–∏—â–µ</div><div class="info-item-value">‚ö∞Ô∏è ' + node.cemetery + '</div></div>';
            }
            if (node.exogamyNote || node.exogamy) {
                html += '<div class="info-item"><div class="info-item-label">–≠–∫–∑–æ–≥–∞–º–∏—è</div><div class="info-item-value">' + (node.exogamyNote || node.exogamy) + '</div></div>';
            }
            if (node.location) {
                html += '<div class="info-item"><div class="info-item-label">–ú–µ—Å—Ç–æ</div><div class="info-item-value">üìç ' + node.location + '</div></div>';
            }
            if (node.legend) {
                html += '<div class="info-item"><div class="info-item-label">–õ–µ–≥–µ–Ω–¥–∞</div><div class="info-item-value" style="font-style:italic;border-left:3px solid var(--secondary);padding-left:1rem;">"' + node.legend + '"</div></div>';
            }
            if (node.children && node.children.length > 0) {
                html += '<div class="info-item"><div class="info-item-label">–ü–æ–¥–≥—Ä—É–ø–ø—ã (' + node.children.length + ')</div><div class="tag-list">';
                for (let i = 0; i < node.children.length; i++) {
                    html += '<span class="tag">' + node.children[i].name + '</span>';
                }
                html += '</div></div>';
            }

            html += '</div>';
            panel.innerHTML = html;
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–∏—Å–∫–∞
        function setupSearch() {
            const searchInput = document.getElementById('searchInput');
            
            searchInput.addEventListener('input', function(e) {
                const query = e.target.value.toLowerCase().trim();
                if (query.length < 2) {
                    closeSearch();
                    return;
                }
                performSearch(query);
            });

            const filterBtns = document.querySelectorAll('.filter-btn');
            for (let i = 0; i < filterBtns.length; i++) {
                filterBtns[i].addEventListener('click', function(e) {
                    for (let j = 0; j < filterBtns.length; j++) {
                        filterBtns[j].classList.remove('active');
                    }
                    e.target.classList.add('active');
                    currentFilter = e.target.dataset.filter;
                    if (searchInput.value.trim().length >= 2) {
                        performSearch(searchInput.value.toLowerCase().trim());
                    }
                });
            }
        }
        // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞
        function performSearch(query) {
            const filtered = [];
            for (let i = 0; i < flatData.length; i++) {
                const item = flatData[i];
                const matchesType = currentFilter === 'all' || item.type === currentFilter;
                const matchesQuery = item.name.toLowerCase().indexOf(query) !== -1;
                if (matchesType && matchesQuery) {
                    filtered.push(item);
                }
            }

            document.getElementById('searchResults').classList.add('active');
            document.getElementById('mainContent').style.display = 'none';

            const resultsList = document.getElementById('resultsList');
            if (filtered.length === 0) {
                resultsList.innerHTML = '<div class="empty-state">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
                return;
            }

            let html = '';
            for (let i = 0; i < Math.min(filtered.length, 10); i++) {
                const item = filtered[i];
                html += '<div class="result-card" onclick="goToResult(\'' + item.id + '\')">';
                html += '<div class="result-icon">' + getIcon(item.type) + '</div>';
                html += '<div class="result-info"><h3>' + item.name + '</h3>';
                html += '<div class="result-path">' + item.pathNames + '</div></div></div>';
            }
            resultsList.innerHTML = html;
        }

        // –ó–∞–∫—Ä—ã—Ç—å –ø–æ–∏—Å–∫
        function closeSearch() {
            document.getElementById('searchResults').classList.remove('active');
            document.getElementById('mainContent').style.display = 'grid';
            document.getElementById('searchInput').value = '';
        }

        // –ü–µ—Ä–µ–π—Ç–∏ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
        function goToResult(id) {
            closeSearch();
            navigationStack = ['root'];
            const path = getPath(id);
            for (let i = 1; i < path.length; i++) {
                navigationStack.push(path[i].id);
            }
            renderTree(id);
        }

        // –ü–æ–ª—É—á–∏—Ç—å –∏–∫–æ–Ω–∫—É
        function getIcon(type) {
            const icons = { 
                arys: 'ü¶Ö', ulken: 'üå≥', 
                uruu: 'üèòÔ∏è', tiyre: 'üè†', 
                root: 'üèõÔ∏è' 
            };
            return icons[type] || 'üìã';
        }

        // –ó–∞–ø—É—Å–∫
        init();
    </script>
</body>
</html>

